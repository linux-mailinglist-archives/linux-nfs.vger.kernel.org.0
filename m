Return-Path: <linux-nfs-owner@vger.kernel.org>
X-Original-To: lists+linux-nfs@lfdr.de
Delivered-To: lists+linux-nfs@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 09ED461596
	for <lists+linux-nfs@lfdr.de>; Sun,  7 Jul 2019 18:45:42 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727341AbfGGQpk (ORCPT <rfc822;lists+linux-nfs@lfdr.de>);
        Sun, 7 Jul 2019 12:45:40 -0400
Received: from mail2-relais-roc.national.inria.fr ([192.134.164.83]:59302 "EHLO
        mail2-relais-roc.national.inria.fr" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S1727335AbfGGQpk (ORCPT
        <rfc822;linux-nfs@vger.kernel.org>); Sun, 7 Jul 2019 12:45:40 -0400
X-IronPort-AV: E=Sophos;i="5.63,463,1557180000"; 
   d="scan'208";a="390776152"
Received: from abo-12-105-68.mrs.modulonet.fr (HELO hadrien) ([85.68.105.12])
  by mail2-relais-roc.national.inria.fr with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 07 Jul 2019 18:45:38 +0200
Date:   Sun, 7 Jul 2019 18:45:38 +0200 (CEST)
From:   Julia Lawall <julia.lawall@lip6.fr>
X-X-Sender: jll@hadrien
To:     Trond Myklebust <trond.myklebust@hammerspace.com>
cc:     Anna Schumaker <anna.schumaker@netapp.com>,
        linux-nfs@vger.kernel.org, linux-kernel@vger.kernel.org,
        linux-nfs@vger.kernel.org, kbuild-all@01.org
Subject: [PATCH] NFS: fix ifnullfree.cocci warnings
Message-ID: <alpine.DEB.2.21.1907071844310.2521@hadrien>
User-Agent: Alpine 2.21 (DEB 202 2017-01-01)
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Sender: linux-nfs-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-nfs.vger.kernel.org>
X-Mailing-List: linux-nfs@vger.kernel.org

From: kbuild test robot <lkp@intel.com>

fs/nfs/sysfs.c:125:2-7: WARNING: NULL check before some freeing functions is not needed.

 NULL check before some freeing functions is not needed.

 Based on checkpatch warning
 "kfree(NULL) is safe this check is probably not required"
 and kfreeaddr.cocci by Julia Lawall.

Generated by: scripts/coccinelle/free/ifnullfree.cocci

Fixes: bf11fbdb20b3 ("NFS: Add sysfs support for per-container identifier")
Signed-off-by: kbuild test robot <lkp@intel.com>
Signed-off-by: Julia Lawall <julia.lawall@lip6.fr>
---

tree:   git://git.linux-nfs.org/projects/trondmy/linux-nfs.git linux-next
head:   c433a7975cfc839906aaa891f68d86ca228f7e43
commit: bf11fbdb20b385157b046ea7781f04d0c62554a3 [30/57] NFS: Add sysfs support for per-container identifier
:::::: branch date: 22 hours ago
:::::: commit date: 22 hours ago

Please take the patch only if it's a positive warning. Thanks!

 sysfs.c |    3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

--- a/fs/nfs/sysfs.c
+++ b/fs/nfs/sysfs.c
@@ -121,8 +121,7 @@ static void nfs_netns_client_release(str
 			struct nfs_netns_client,
 			kobject);

-	if (c->identifier)
-		kfree(c->identifier);
+	kfree(c->identifier);
 	kfree(c);
 }

