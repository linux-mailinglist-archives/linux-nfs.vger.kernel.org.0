Return-Path: <linux-nfs-owner@vger.kernel.org>
X-Original-To: lists+linux-nfs@lfdr.de
Delivered-To: lists+linux-nfs@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 38FB1483756
	for <lists+linux-nfs@lfdr.de>; Mon,  3 Jan 2022 20:03:05 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S235964AbiACTDE (ORCPT <rfc822;lists+linux-nfs@lfdr.de>);
        Mon, 3 Jan 2022 14:03:04 -0500
Received: from outgoing-stata.csail.mit.edu ([128.30.2.210]:47823 "EHLO
        outgoing-stata.csail.mit.edu" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S235959AbiACTDD (ORCPT
        <rfc822;linux-nfs@vger.kernel.org>); Mon, 3 Jan 2022 14:03:03 -0500
Received: from c-73-149-22-248.hsd1.ma.comcast.net ([73.149.22.248] helo=crash.local)
        by outgoing-stata.csail.mit.edu with esmtpsa (TLS1.2:DHE_RSA_AES_256_CBC_SHA256:256)
        (Exim 4.82)
        (envelope-from <rtm@csail.mit.edu>)
        id 1n4Sbk-00090s-Ey; Mon, 03 Jan 2022 14:03:00 -0500
Received: from crash.local (localhost [127.0.0.1])
        by crash.local (Postfix) with ESMTP id 0A385145197B2;
        Mon,  3 Jan 2022 14:03:00 -0500 (EST)
to:     Trond Myklebust <trond.myklebust@hammerspace.com>,
        Anna Schumaker <anna.schumaker@netapp.com>
cc:     linux-nfs@vger.kernel.org
From:   rtm@csail.mit.edu
Reply-To: rtm@csail.mit.edu
Subject: _nfs4_open_and_get_state() should check IS_ERR() from d_splice_alias()
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="=-=-="
Date:   Mon, 03 Jan 2022 14:02:59 -0500
Message-ID: <98916.1641236579@crash.local>
Precedence: bulk
List-ID: <linux-nfs.vger.kernel.org>
X-Mailing-List: linux-nfs@vger.kernel.org

--=-=-=
Content-Type: text/plain

_nfs4_open_and_get_state() says:

                if (!alias)
                        alias = d_splice_alias(igrab(state->inode), dentry);
                /* d_splice_alias() can't fail here - it's a non-directory */
                if (alias) {
                        dput(ctx->dentry);
                        ctx->dentry = dentry = alias;
                ...;
                nfs_set_verifier(dentry, dir_verifier);
  
d_splice_alias() can return an ERR_PTR(), causing nfs_set_verifier() to
page-fault on &dentry->d_lock; I've attached a demo.
  
# uname -a
Linux (none) 5.16.0-rc7-00108-g800829388818-dirty #12 SMP Mon Jan 3 18:38:50 UTC 2022 riscv64 riscv64 riscv64 GNU/Linux
# cc nfs_18.c
# ./a.out
...
[   71.811841] VFS: Lookup of 'x' in nfs4 0:16 would have caused loop
[   71.825707] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000034
[   72.064187] status: 0000000200000121 badaddr: 0000000000000034 cause: 000000000000000d
[   72.079110] [<ffffffff8004dfbc>] do_raw_spin_lock+0xa/0xd8
[   72.090221] [<ffffffff8064b9f2>] _raw_spin_lock+0x1a/0x22
[   72.101284] [<ffffffff80201944>] nfs_set_verifier+0x20/0x6a
[   72.112387] [<ffffffff8022a8b2>] nfs4_do_open.constprop.0+0x30e/0x874
[   72.125597] [<ffffffff8022aeb0>] nfs4_atomic_open+0xc/0x1c
[   72.136676] [<ffffffff802036f8>] nfs_atomic_open+0x1a0/0x35e
[   72.150205] [<ffffffff80137a7c>] path_openat+0x59e/0xadc
[   72.161311] [<ffffffff801391c8>] do_filp_open+0x70/0xea
[   72.172464] [<ffffffff801286f4>] do_sys_openat2+0x86/0x11a
[   72.183523] [<ffffffff80128a6a>] sys_openat+0x40/0x80
[   72.194578] [<ffffffff80003030>] ret_from_syscall+0x0/0x2
[   72.213692] ---[ end trace 107b62634b79d2f7 ]---


--=-=-=
Content-Type: application/octet-stream
Content-Disposition: attachment; filename=nfs_18.c
Content-Transfer-Encoding: base64

I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPHN0ZGxpYi5o
PgojZGVmaW5lIF9HTlVfU09VUkNFCiNpbmNsdWRlIDx1bmlzdGQuaD4KI2luY2x1ZGUgPHN5cy9z
b2NrZXQuaD4KI2luY2x1ZGUgPHN5cy9maWxlLmg+CiNpbmNsdWRlIDxzeXMvaW9jdGwuaD4KI2lu
Y2x1ZGUgPG5ldGluZXQvaW4uaD4KI2luY2x1ZGUgPHN5cy93YWl0Lmg+CiNpbmNsdWRlIDxzeXMv
cmVzb3VyY2UuaD4KI2luY2x1ZGUgPHN5cy9wYXJhbS5oPgojaW5jbHVkZSA8c3lzL21vdW50Lmg+
CiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+CiNpbmNsdWRlIDxz
eXMvdmZzLmg+CiNpbmNsdWRlIDxkaXJlbnQuaD4KI2luY2x1ZGUgPGFzc2VydC5oPgojaW5jbHVk
ZSA8ZmNudGwuaD4KI2luY2x1ZGUgPGVycm5vLmg+CgppbnQgc3ltX29wID0gMTg7CmludCBzeW1f
c2tpcCA9IDA7CmludCBzeW1fdHlwZSA9IDA7IC8vIGFsbCBmYXR0cjQgZmlsZSB0eXBlcwppbnQg
c3ltX2ZoID0gMDsgLy8gYWxsIGZpbGUgaGFuZGxlcwppbnQgc3ltX2JpdG1hcHMgPSAwOwppbnQg
c3ltX29wYXF1ZV9sZW4gPSAwOwoKaW50IG9wY291bnRzWzI1Nl07CmxvbmcgbG9uZyBuZXh0X2Nv
b2tpZSA9IDM7CmludCBjdXJyZW50X2ZoID0gMDsKaW50IGNvbXBvdW5kX3N0YXR1czsKaW50IHNl
bmRfYmFjazsKCi8vIG1hcCBmaWxlL2RpciBuYW1lcyB0byBmaWxlIGhhbmRsZQpjaGFyICpmaG5h
bWVzWzEwMF0gPSB7CiAgICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgICAidG1wIiwKICAg
ICAgICAgICAgICAgIngiLAogICAgICAgICAgICAgICAieSIsCiAgICAgICAgICAgICAgICJ6IiwK
ICAgICAgICAgICAgICAgInp6eiIsCiAgICAgICAgICAgICAgIDAKfTsKCmludApuYW1lMmZoKGNo
YXIgKm5hbWUsIGludCBjcmVhdGUpCnsKICBmb3IoaW50IGkgPSAwOyBmaG5hbWVzW2ldOyBpKysp
ewogICAgaWYoc3RyY21wKG5hbWUsIGZobmFtZXNbaV0pID09IDApCiAgICAgIHJldHVybiBpOwog
IH0KICBpZihjcmVhdGUpewogICAgZm9yKGludCBpID0gMDsgOyBpKyspewogICAgICBpZihmaG5h
bWVzW2ldID09IDApewogICAgICAgIGZobmFtZXNbaV0gPSBtYWxsb2MoMTAwKTsKICAgICAgICBz
dHJjcHkoZmhuYW1lc1tpXSwgbmFtZSk7CiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0KICAgIH0K
ICB9CiAgcmV0dXJuIC0xOwp9CgojZGVmaW5lIE5BQSAxMjgKdW5zaWduZWQgbG9uZyBsb25nIGFh
W05BQV0gPSB7CjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGws
CjB4MHVsbCwKMHgwdWxsLAoweDJ1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwK
MHgwdWxsLAoweGMwMDAwMDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgw
dWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1
bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVs
bCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxs
LAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGws
CjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwK
MHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAow
eDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4
MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgw
dWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1
bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVs
bCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxs
LAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGws
CjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwK
MHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAow
eDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4
MHVsbCwKMHgwdWxsLAp9OwppbnQgYWFpID0gMDsKCmNoYXIgaWJ1ZlsxNioxMDI0XTsKaW50IGls
ZW4gPSAwOwppbnQgaWkgPSAwOwpjaGFyIG9idWZbMTYqMTAyNF07CmludCBvaSA9IDA7CmludCBz
eW1zdGFydCA9IC0xOwoKaW50IHJlYWRuKGludCBmZCwgdm9pZCAqeGJ1ZiwgaW50IG4pIHsKICBj
aGFyICpidWYgPSAoY2hhciAqKSB4YnVmOwogIGludCBvcmlnID0gbjsKICB3aGlsZShuID4gMCl7
CiAgICBpbnQgY2MgPSByZWFkKGZkLCBidWYsIG4pOwogICAgaWYoY2MgPD0gMCkgeyBwZXJyb3Io
InJlYWQiKTsgcmV0dXJuIC0xOyB9CiAgICBuIC09IGNjOwogICAgYnVmICs9IGNjOwogIH0KICBy
ZXR1cm4gb3JpZzsKfQoKdW5zaWduZWQgaW50CnBhcnNlMzIoKQp7CiAgaWYoaWkgPj0gaWxlbil7
CiAgICBwcmludGYoInBhcnNlZCBiZXlvbmQgdGhlIGVuZCBvZiB0aGUgaW5wdXRcbiIpOwogICAg
cmV0dXJuIDB4ZmZmZmZmZmY7CiAgfQogIHVuc2lnbmVkIGludCB4ID0gKihpbnQqKShpYnVmK2lp
KTsKICBpaSArPSA0OwogIHJldHVybiBudG9obCh4KTsKfQoKdW5zaWduZWQgbG9uZyBsb25nCnBh
cnNlNjQoKQp7CiAgdW5zaWduZWQgbG9uZyBsb25nIGhpID0gcGFyc2UzMigpOwogIHVuc2lnbmVk
IGxvbmcgbG9uZyBsbyA9IHBhcnNlMzIoKTsKICByZXR1cm4gKGhpIDw8IDMyKSB8IGxvOwp9Cgov
LyBzZXNzaW9uaWQ0IC0tIDE2IGJ5dGVzCnZvaWQKcGFyc2Vfc2lkKGNoYXIgKnNpZCkKewogIGZv
cihpbnQgaSA9IDA7IGkgPCAxNjsgaSsrKXsKICAgIGlmKHNpZCkKICAgICAgc2lkW2ldID0gaWJ1
ZltpaV07CiAgICBpaSsrOwogIH0KfQoKdW5zaWduZWQgaW50CnBhcnNlX29wYXF1ZShjaGFyICpi
dWYpCnsKICBpZihidWYpCiAgICBidWZbMF0gPSAwOwogIGludCBub21pbmFsX24gPSBwYXJzZTMy
KCk7CiAgaWYobm9taW5hbF9uID4gNDA5Nil7CiAgICBwcmludGYoImNyYXp5IG9wYXF1ZSBsZW5n
dGggJWRcbiIsIG5vbWluYWxfbik7CiAgICByZXR1cm4gMDsKICB9CiAgaW50IHJlYWxfbiA9IG5v
bWluYWxfbjsKICB3aGlsZSgocmVhbF9uJTQpICE9IDApIHJlYWxfbiArPSAxOwogIGZvcihpbnQg
aSA9IDA7IGkgPCByZWFsX247IGkrKyl7CiAgICBpZihidWYgJiYgaSA8IHJlYWxfbikKICAgICAg
YnVmW2ldID0gaWJ1ZltpaV07CiAgICBpaSsrOwogIH0KICByZXR1cm4gbm9taW5hbF9uOwp9Cgp2
b2lkCnB1dDMyKHVuc2lnbmVkIGludCB4KQp7CiAgYXNzZXJ0KChvaSAlIDQpID09IDApOwogICoo
aW50Kikob2J1ZitvaSkgPSBodG9ubCh4KTsKICBvaSArPSA0Owp9Cgp2b2lkCnB1dDY0KHVuc2ln
bmVkIGxvbmcgbG9uZyB4KQp7CiAgcHV0MzIoeCA+PiAzMik7CiAgcHV0MzIoeCk7Cn0KCnZvaWQK
cHV0X29wYXF1ZShpbnQgbiwgY2hhciAqYnVmKQp7CiAgaW50IG5uID0gbjsKICBpZihzeW1fb3Bh
cXVlX2xlbiAmJiBhYWkgPCBOQUEpCiAgICBubiBePSBhYVthYWkrK107CiAgcHV0MzIobm4pOwog
IGZvcihpbnQgaSA9IDA7IGkgPCBuOyBpKyspCiAgICBvYnVmW29pKytdID0gKGJ1ZiA/IGJ1Zltp
XSA6IDApOwogIHdoaWxlKG4gJiAzKXsKICAgIG9idWZbb2krK10gPSAwOwogICAgbisrOwogIH0K
fQoKdm9pZApwdXRfc2lkKGNoYXIgKnNpZCkKewogIGZvcihpbnQgaSA9IDA7IGkgPCAxNjsgaSsr
KXsKICAgIG9idWZbb2krK10gPSAoc2lkID8gc2lkW2ldIDogMCk7CiAgfQp9Cgp2b2lkCnBhcnNl
X25vcCgpCnsKfQoKdm9pZApwYXJzZV9vcF9leGNoYW5nZV9pZCgpCnsKICBwYXJzZTMyKCk7IC8v
IHZlcmlmaWVyNCwgZmlyc3QgaGFsZgogIHBhcnNlMzIoKTsgLy8gdmVyaWZpZXI0LCBzZWNvbmQg
aGFsZgogIHBhcnNlX29wYXF1ZSgwKTsgLy8gZWlhX2NsaWVudG93bmVyCiAgaW50IGNmbGFncyA9
IHBhcnNlMzIoKTsgLy8gZWlhX2ZsYWdzCiAgcGFyc2UzMigpOyAvLyBzdGF0ZV9wcm90ZWN0NF9h
LnNwYV9ob3csIGFzc3VtZSBTUDRfTk9ORQogIGludCBuaW1wbCA9IHBhcnNlMzIoKTsgLy8gbGVu
Z3RoIG9mIGNsaWVudF9pbXBsX2lkCiAgZm9yKGludCBpbXBsaSA9IDA7IGltcGxpIDwgbmltcGw7
IGltcGxpKyspewogICAgY2hhciBqdW5rWzUxMl07CiAgICBwYXJzZV9vcGFxdWUoanVuayk7IC8v
IG5paV9kb21haW4KICAgIC8vIHByaW50ZigibmlpX2RvbWFpbjogJXNcbiIsIGp1bmspOwogICAg
cGFyc2Vfb3BhcXVlKGp1bmspOyAvLyBuaWlfbmFtZQogICAgLy8gcHJpbnRmKCJuaWlfbmFtZTog
JXNcbiIsIGp1bmspOwogICAgcGFyc2U2NCgpOyAvLyAxLzIgb2YgbmZzdGltZTQKICAgIHBhcnNl
MzIoKTsgLy8gMS8yIG9mIG5mc3RpbWU0CiAgfQoKICAvLyBmaW5pc2ggRVhDSEFOR0VfSUQ0cmVz
CiAgcHV0MzIoMCk7IC8vIGVpcl9zdGF0dXMgPSBORlM0X09LCiAgcHV0NjQoMSk7IC8vIGNsaWVu
dGlkNAogIHB1dDMyKDEpOyAvLyBzZXF1ZW5jZWlkNAogIGludCBzZmxhZ3MgPSAweDEwMyB8IDB4
MTAwMDA7IC8vIEVYQ0hHSUQ0X0ZMQUdfVVNFX05PTl9QTkZTCiAgcHV0MzIoc2ZsYWdzKTsgLy8g
ZWlyX2ZsYWdzCiAgcHV0MzIoMCk7IC8vIHN0YXRlX3Byb3RlY3Q0X3Iuc3ByX2hvdyA9IFNQNF9O
T05FCiAgcHV0NjQoMSk7IC8vIHNlcnZlcl9vd25lcjQuc29fbWlub3JfaWQKICBwdXQzMig0KTsg
Ly8gbGVuZ3RoIG9mIHNvX21ham9yX2lkPD4KICBwdXQzMigweDExMjIzMzQ0KTsgLy8gc29fbWFq
b3JfaWQ8PgogIHB1dDMyKDQpOyAvLyBsZW5ndGggb2YgZWlyX3NlcnZlcl9zY29wZQogIHB1dDMy
KDB4MTEyMjMzNDQpOwogIHB1dDMyKDEpOyAvLyBsZW5ndGggb2YgZWlyX3NlcnZlcl9pbXBsX2lk
PDE+CiAgcHV0MzIoNCk7IC8vIG5mc19pbXBsX2lkNC5uaWlfZG9tYWluCiAgcHV0MzIoMHgxMTIy
MzM0NCk7CiAgcHV0MzIoNCk7IC8vIG5mc19pbXBsX2lkNC5uaWlfbmFtZQogIHB1dDMyKDB4MTEy
MjMzNDQpOwogIHB1dDY0KDApOyAvLyBuaWlfZGF0ZSAxLzIKICBwdXQzMigwKTsgLy8gbmlpX2Rh
dGUgMi8yCn0KCnZvaWQKcGFyc2Vfb3BfY3JlYXRlX3Nlc3Npb24oKQp7CiAgcGFyc2U2NCgpOyAv
LyBjc2FfY2xpZW50aWQKICBpbnQgc2VxID0gcGFyc2UzMigpOyAvLyBjc2Ffc2VxdWVuY2UKICBw
YXJzZTMyKCk7IC8vIGNzYV9mbGFncwogIC8vIGNzYV9mb3JlX2NoYW5fYXR0cnMsIGNzYV9iYWNr
X2NoYW5fYXR0cnMKICBpbnQgYXR0cnNbMl1bNl07CiAgZm9yKGludCBpID0gMDsgaSA8IDI7IGkr
Kyl7CiAgICBmb3IoaW50IGogPSAwOyBqIDwgNjsgaisrKXsKICAgICAgYXR0cnNbaV1bal0gPSBw
YXJzZTMyKCk7CiAgICB9CiAgICBwYXJzZV9vcGFxdWUoMCk7IC8vIGNhX3JkbWFfaXJkPDE+CiAg
fQogIC8vIFhYWAogIGlpID0gaWxlbjsKCiAgcHV0MzIoMCk7IC8vIE9LCiAgZm9yKGludCBpID0g
MDsgaSA8IDQ7IGkrKykKICAgIHB1dDMyKDEpOyAvLyBjc3Jfc2Vzc2lvbmlkIGkvNAogIHB1dDMy
KHNlcSk7IC8vIGNzcl9zZXF1ZW5jZQogIHB1dDMyKDB4Myk7IC8vIGNzcl9mbGFncwoKICBmb3Io
aW50IGkgPSAwOyBpIDwgMjsgaSsrKXsKICAgIGZvcihpbnQgaiA9IDA7IGogPCA2OyBqKyspCiAg
ICAgIHB1dDMyKGF0dHJzW2ldW2pdKTsKICAgIHB1dDMyKDApOyAvLyBjYV9yZG1hX2lyZAogIH0K
fQoKdm9pZApwYXJzZV9vcF9zZXF1ZW5jZSgpCnsKICBjaGFyIHNpZFsxNl07CgogIHBhcnNlX3Np
ZChzaWQpOyAvLyBzYV9zZXNzaW9uaWQKICBpbnQgc2VxID0gcGFyc2UzMigpOyAvLyBzYV9zZXF1
ZW5jZWlkCiAgaW50IHNsb3QgPSBwYXJzZTMyKCk7IC8vIHNhX3Nsb3RpZAogIGludCBoaXNsb3Qg
PSBwYXJzZTMyKCk7IC8vIHNhX2hpZ2hlc3Rfc2xvdGlkCiAgcGFyc2UzMigpOyAvLyBzYV9jYWNo
ZXRoaXMKCiAgcHV0MzIoMCk7IC8vIE9LCiAgcHV0X3NpZChzaWQpOyAvLyBzcl9zZXNzaW9uaWQK
ICBwdXQzMihzZXEpOyAvLyBzcl9zZXF1ZW5jZWlkCiAgcHV0MzIoc2xvdCk7IC8vIHNyX3Nsb3Rp
ZAogIHB1dDMyKGhpc2xvdCk7IC8vIHNyX2hpZ2hlc3Rfc2xvdGlkCiAgcHV0MzIoaGlzbG90KTsg
Ly8gc3JfdGFyZ2V0X2hpZ2hlc3Rfc2xvdGlkCiAgcHV0MzIoMCk7IC8vIHNyX3N0YXR1c19mbGFn
cwp9Cgp2b2lkCnBhcnNlX29wX3JlY2xhaW1fY29tcGxldGUoKQp7CiAgcGFyc2UzMigpOyAvLyBy
Y2Ffb25lX2ZzCiAgcHV0MzIoMCk7IC8vIHJjcl9zdGF0dXMKfQoKdm9pZApwYXJzZV9vcF9wdXRy
b290ZmgoKQp7CiAgLy8gbm8gYXJndW1lbnRzCiAgcHV0MzIoMCk7IC8vIE9LCiAgY3VycmVudF9m
aCA9IDA7Cn0KCnZvaWQKcGFyc2Vfb3Bfc2VjaW5mb19ub19uYW1lKCkKewogIHBhcnNlMzIoKTsg
Ly8gc2VjaW5mb19zdHlsZTQKICBwdXQzMigwKTsgLy8gT0sKICBwdXQzMigxKTsgLy8gIyBvZiBz
ZWNpbmZvNAojaWYgMQogIHB1dDMyKDApOyAvLyBmbGF2b3IgPSBBVVRIX05VTEwKI2Vsc2UKICBw
dXQzMig2KTsgLy8gZmxhdm9yID0gUlBDU0VDX0dTUwogIHB1dDMyKDQpOyAvLyBzaXplIG9mIHNl
Y19vaWQ0CiAgcHV0MzIoMHhmZmZmZmZmZik7CiAgcHV0MzIoMCk7IC8vIHFvcDQKICBwdXQzMigx
KTsgLy8gcnBjX2dzc19zdmNfdAojZW5kaWYKfQoKdm9pZApwYXJzZV9vcF9kZXN0cm95X3Nlc3Np
b24oKQp7CiAgcGFyc2Vfc2lkKDApOwogIHB1dDMyKDApOyAvLyBPSwp9Cgp2b2lkCnBhcnNlX29w
X2Rlc3Ryb3lfY2xpZW50aWQoKQp7CiAgcGFyc2U2NCgpOyAvLyBjbGllbnRpZAogIHB1dDMyKDAp
OyAvLyBPSwp9Cgp2b2lkCnBhcnNlX29wX2dldGZoKCkKewogIC8vIG5vIGFyZ3VtZW50cwogIHB1
dDMyKDApOyAvLyBPSwogIGludCB4ZmggPSBjdXJyZW50X2ZoOwogIGlmKHN5bV9maCkgeGZoIF49
IGFhW2FhaSsrXTsKICBwdXRfb3BhcXVlKDQsIChjaGFyKikmeGZoKTsgLy8gZmgKfQoKLy8KLy8g
Y2FsbGVkIGJ5IGdldGF0dHIgYW5kIHJlYWRkaXIuCi8vIGdlbmVyYXRlcyBhIGZhdHRyNCAoYml0
bWFwNCB0aGVuIGF0dHJsaXN0NCkuCi8vCnZvaWQKcHV0X2ZhdHRyNChpbnQgeHdvcmRzW10sIGlu
dCBmaCkKewogIGludCB3b3Jkc1szXTsKICBmb3IoaW50IGkgPSAwOyBpIDwgMzsgaSsrKXsKICAg
IHdvcmRzW2ldID0geHdvcmRzW2ldOwogICAgaWYoc3ltX2JpdG1hcHMpewogICAgICB3b3Jkc1tp
XSBePSBhYVthYWkrK107CiAgICB9CiAgfQogIGludCBiaXR3b3JkcyA9IDM7CiAgcHV0MzIoYml0
d29yZHMpOwogIGludCB3b3JkMGkgPSBvaTsKICBmb3IoaW50IGkgPSAwOyBpIDwgYml0d29yZHM7
IGkrKykKICAgIHB1dDMyKHdvcmRzW2ldKTsKICBpbnQgbGVuaSA9IG9pOwogIHB1dDMyKDApOyAv
LyBwbGFjZWhvbGRlciBmb3IgdG90YWwgbGVuZ3RoIG9mIGF0dHJzCiAgZm9yKGludCBhID0gMDsg
YSA8IGJpdHdvcmRzKjMyOyBhKyspewogICAgaWYod29yZHNbYS8zMl0gJiAoMSA8PCAoYSAlIDMy
KSkpewogICAgICBpZihhID09IDApewogICAgICAgIHB1dDMyKDMpOyAvLyAjIGJpdG1hcCB3b3Jk
cyBvZiBzdXBwb3J0ZWQgYXR0cnMKICAgICAgICBwdXQzMigweGZmZmZmZmZmKTsKICAgICAgICBw
dXQzMigweGZmZmZmZmZmKTsKICAgICAgICBwdXQzMigweGZmZmZmZmZmKTsKICAgICAgfSBlbHNl
IGlmKGEgPT0gMSl7CiAgICAgICAgaW50IHR5cGUgPSAxOwogICAgICAgIGlmKGZoID09IDAgfHwg
ZmggPT0gMSkKICAgICAgICAgIHR5cGUgPSAyOwogICAgICAgIGlmKHN5bV90eXBlKSB0eXBlIF49
IGFhW2FhaSsrXTsKICAgICAgICBwdXQzMih0eXBlKTsgLy8gTkY0RElSPTIgb3IgTkY0UkVHPTEK
ICAgICAgfSBlbHNlIGlmKGEgPT0gMil7CiAgICAgICAgcHV0MzIoMCk7IC8vIGZoX2V4cGlyZV90
eXBlCiAgICAgIH0gZWxzZSBpZihhID09IDMpewogICAgICAgIHB1dDY0KDApOyAvLyBjaGFuZ2UK
ICAgICAgfSBlbHNlIGlmKGEgPT0gNCl7CiAgICAgICAgcHV0NjQoNDA5NioxMCk7IC8vIHNpemUK
ICAgICAgfSBlbHNlIGlmKGEgPT0gNSl7CiAgICAgICAgcHV0MzIoMSk7IC8vIGxpbmsgc3VwcG9y
dAogICAgICB9IGVsc2UgaWYoYSA9PSA2KXsKICAgICAgICBwdXQzMigxKTsgLy8gc3ltbGluayBz
dXBwb3J0CiAgICAgIH0gZWxzZSBpZihhID09IDgpewogICAgICAgIHB1dDY0KDEpOyAvLyBmc2lk
IG1ham9yCiAgICAgICAgcHV0NjQoMSk7IC8vIGZzaWQgbWlub3IKICAgICAgfSBlbHNlIGlmKGEg
PT0gMTApewogICAgICAgIHB1dDMyKDEwKTsgLy8gbGVhc2UgdGltZQogICAgICB9IGVsc2UgaWYo
YSA9PSAxMSl7CiAgICAgICAgcHV0MzIoMCk7IC8vIHJkYXR0cl9lcnJvcgogICAgICB9IGVsc2Ug
aWYoYSA9PSAxMil7CiAgICAgICAgLy8gQUNMCiAgICAgICAgaW50IG4gPSAyOwogICAgICAgIHB1
dDMyKG4pOwogICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBuOyBpKyspewogICAgICAgICAgcHV0
MzIoMCk7IC8vIHR5cGUKICAgICAgICAgIHB1dDMyKDApOyAvLyBmbGFnCiAgICAgICAgICBwdXQz
MigwKTsgLy8gbWFzawogICAgICAgICAgY2hhciB3aG9bOV07CiAgICAgICAgICBtZW1zZXQod2hv
LCAwLCBzaXplb2Yod2hvKSk7CiAgICAgICAgICBzdHJjcHkod2hvLCAibm9ib2R5Iik7CiAgICAg
ICAgICBwdXRfb3BhcXVlKHN0cmxlbih3aG8pLCB3aG8pOwogICAgICAgIH0KICAgICAgfSBlbHNl
IGlmKGEgPT0gMTMpewogICAgICAgIHB1dDMyKDB4Zik7IC8vIGFjbHN1cHBvcnQKICAgICAgfSBl
bHNlIGlmKGEgPT0gMTUpewogICAgICAgIHB1dDMyKDEpOyAvLyBjYW5zZXR0aW1lCiAgICAgIH0g
ZWxzZSBpZihhID09IDE2KXsKICAgICAgICBwdXQzMigwKTsgLy8gY2FzZSBpbnNlbnNpdGl2ZQog
ICAgICB9IGVsc2UgaWYoYSA9PSAxNyl7CiAgICAgICAgcHV0MzIoMSk7IC8vIGNhc2UgcHJlc2Vy
dmluZwogICAgICB9IGVsc2UgaWYoYSA9PSAxOCl7CiAgICAgICAgcHV0MzIoMCk7IC8vIGNob3du
X3Jlc3RyaWN0ZWQKICAgICAgfSBlbHNlIGlmKGEgPT0gMTkpewogICAgICAgIC8vIGZpbGVoYW5k
bGUKICAgICAgICBpbnQgeGZoID0gZmg7CiAgICAgICAgaWYoc3ltX2ZoKSB4ZmggXj0gYWFbYWFp
KytdOwogICAgICAgIHB1dF9vcGFxdWUoNCwgKGNoYXIqKSZ4ZmgpOyAvLyBmaAogICAgICB9IGVs
c2UgaWYoYSA9PSAyMCl7CiAgICAgICAgcHV0NjQoZmgpOyAvLyBmaWxlaWQKICAgICAgfSBlbHNl
IGlmKGEgPT0gMjEpewogICAgICAgIHB1dDY0KDk5OTkpOyAvLyBmaWxlc19hdmFpbAogICAgICB9
IGVsc2UgaWYoYSA9PSAyMil7CiAgICAgICAgcHV0NjQoOTk5OSk7IC8vIGZpbGVzX2ZyZWUKICAg
ICAgfSBlbHNlIGlmKGEgPT0gMjMpewogICAgICAgIHB1dDY0KDk5OTk5KTsgLy8gZmlsZXNfdG90
YWwKICAgICAgfSBlbHNlIGlmKGEgPT0gMjQpewogICAgICAgIC8vIGZzX2xvY2F0aW9ucwogICAg
ICAgIHB1dDMyKDEpOwogICAgICAgIHB1dF9vcGFxdWUoMTAsICJhYmNkZTEyMzQ1Iik7IC8vIHBh
dGhuYW1lNAogICAgICAgIHB1dDMyKDEpOyAvLyBsb2NhdGlvbnM8PgogICAgICAgIHB1dF9vcGFx
dWUoMTAsICJhYmNkZTEyMzQ1Iik7IC8vIHNlcnZlcgogICAgICAgIHB1dDMyKDEpOwogICAgICAg
IHB1dF9vcGFxdWUoMTAsICJhYmNkZTEyMzQ1Iik7IC8vIHJvb3RwYXRoCiAgICAgIH0gZWxzZSBp
ZihhID09IDI2KXsKICAgICAgICBwdXQzMigxKTsgLy8gaG9tb2dlbmVvdXMKICAgICAgfSBlbHNl
IGlmKGEgPT0gMjcpewogICAgICAgIHB1dDY0KDB4ZmZmZmZmZmZmZmZmKTsgLy8gbWF4IGZpbGUg
c2l6ZQogICAgICB9IGVsc2UgaWYoYSA9PSAyOCl7CiAgICAgICAgcHV0MzIoMHhmZmZmKTsgLy8g
bWF4IGxpbmsKICAgICAgfSBlbHNlIGlmKGEgPT0gMjkpewogICAgICAgIHB1dDMyKDI1Nik7IC8v
IG1heCBuYW1lCiAgICAgIH0gZWxzZSBpZihhID09IDMwKXsKICAgICAgICBwdXQ2NCgxMCo0MDk2
KTsgLy8gbWF4IHJlYWQKICAgICAgfSBlbHNlIGlmKGEgPT0gMzEpewogICAgICAgIHB1dDY0KDEw
KjQwOTYpOyAvLyBtYXggd3JpdGUKICAgICAgfSBlbHNlIGlmKGEgPT0gMzMpewogICAgICAgIHB1
dDMyKDA3NzcpOyAvLyBtb2RlCiAgICAgIH0gZWxzZSBpZihhID09IDM0KXsKICAgICAgICBwdXQz
MigxKTsgLy8gbm9fdHJ1bmMKICAgICAgfSBlbHNlIGlmKGEgPT0gMzUpewogICAgICAgIHB1dDMy
KDMpOyAvLyBudW1saW5rcwogICAgICB9IGVsc2UgaWYoYSA9PSAzNil7CiAgICAgICAgLy8gcHV0
X29wYXF1ZSg2LCAib3RoZXIiKTsgLy8gb3duZXIKICAgICAgICBwdXRfb3BhcXVlKDYsICJub2Jv
ZHkiKTsgLy8gb3duZXIKICAgICAgICAvLyBwdXRfb3BhcXVlKDUsICI2NTUzNCIpOyAvLyBvd25l
cgogICAgICB9IGVsc2UgaWYoYSA9PSAzNyl7CiAgICAgICAgLy8gcHV0X29wYXF1ZSg2LCAib3Ro
ZXIiKTsgLy8gb3duZXJfZ3JvdXAKICAgICAgICBwdXRfb3BhcXVlKDYsICJub2JvZHkiKTsgLy8g
b3duZXJfZ3JvdXAKICAgICAgICAvLyBwdXRfb3BhcXVlKDUsICI2NTUzNCIpOyAvLyBvd25lcl9n
cm91cAogICAgICB9IGVsc2UgaWYoYSA9PSA0MSl7CiAgICAgICAgcHV0MzIoMCk7IC8vIHJhd2Rl
diBtYWpvcgogICAgICAgIHB1dDMyKDApOyAvLyByYXdkZXYgbWlub3IKICAgICAgfSBlbHNlIGlm
KGEgPT0gNDIpewogICAgICAgIHB1dDY0KDEwKjEwMjQqMTAyNCk7IC8vIHNwYWNlX2F2YWlsCiAg
ICAgIH0gZWxzZSBpZihhID09IDQzKXsKICAgICAgICBwdXQ2NCgxMCoxMDI0KjEwMjQpOyAvLyBz
cGFjZV9mcmVlCiAgICAgIH0gZWxzZSBpZihhID09IDQ0KXsKICAgICAgICBwdXQ2NCgyMCoxMDI0
KjEwMjQpOyAvLyBzcGFjZV90b3RhbAogICAgICB9IGVsc2UgaWYoYSA9PSA0NSl7CiAgICAgICAg
cHV0NjQoNDA5NioxMCk7IC8vIHNwYWNlIHVzZWQKICAgICAgfSBlbHNlIGlmKGEgPT0gNDcpewog
ICAgICAgIHB1dDY0KDApOyAvLyB0aW1lIGFjY2VzcyBzZWNvbmRzCiAgICAgICAgcHV0MzIoMCk7
IC8vIG5zZWNvbmRzCiAgICAgIH0gZWxzZSBpZihhID09IDUwKXsKICAgICAgICBwdXQ2NCgwKTsg
Ly8gdGltZSBjcmVhdGUgc2Vjb25kcwogICAgICAgIHB1dDMyKDApOyAvLyBuc2Vjb25kcwogICAg
ICB9IGVsc2UgaWYoYSA9PSA1MSl7CiAgICAgICAgcHV0NjQoMCk7IC8vIHRpbWUgZGVsdGEgc2Vj
b25kcwogICAgICAgIHB1dDMyKDApOyAvLyBuc2Vjb25kcwogICAgICB9IGVsc2UgaWYoYSA9PSA1
Mil7CiAgICAgICAgcHV0NjQoMCk7IC8vIHRpbWUgbWV0YWRhdGEgc2Vjb25kcwogICAgICAgIHB1
dDMyKDApOyAvLyBuc2Vjb25kcwogICAgICB9IGVsc2UgaWYoYSA9PSA1Myl7CiAgICAgICAgcHV0
NjQoMCk7IC8vIHRpbWUgbW9kaWZ5IHNlY29uZHMKICAgICAgICBwdXQzMigwKTsgLy8gbnNlY29u
ZHMKICAgICAgfSBlbHNlIGlmKGEgPT0gNTUpewogICAgICAgIHB1dDY0KDApOyAvLyBtb3VudGVk
X29uX2ZpbGVpZCA/Pz8KICAgICAgfSBlbHNlIGlmKGEgPT0gNjIpewogICAgICAgIC8vIGZzX2xh
eW91dF90eXBlcwogICAgICAgIHB1dDMyKDEpOwogICAgICAgIHB1dDMyKDEpOyAvLyBMQVlPVVQ0
X05GU1Y0XzFfRklMRVMKICAgICAgfSBlbHNlIGlmKGEgPT0gNjUpewogICAgICAgIC8vIExBWU9V
VF9CTEtTSVpFCiAgICAgICAgcHV0MzIoMTAyNCk7CiAgICAgIH0gZWxzZSBpZihhID09IDc3KXsK
ICAgICAgICAvLyBDTE9ORV9CTEtTSVpFCiAgICAgICAgcHV0MzIoMTAyNCk7CiAgICAgIH0gZWxz
ZSBpZihhID09IDc5KXsKICAgICAgICAvLyBDSEFOR0VfQVRUUl9UWVBFCiAgICAgICAgcHV0MzIo
NCk7IC8vID8/PwogICAgICB9IGVsc2UgaWYoYSA9PSA4Mil7CiAgICAgICAgLy8gQ0hBTkdFX0FU
VFJfVFlQRQogICAgICAgIHB1dDMyKDQpOyAvLyA/Pz8KICAgICAgfSBlbHNlIGlmKGEgPT0gNzUp
ewogICAgICAgIC8vIEZBVFRSNF9TVVBQQVRUUl9FWENMQ1JFQVQKICAgICAgICBwdXQzMigyKTsg
Ly8gYml0bWFwIGxlbmd0aAogICAgICAgIHB1dDMyKDB4ZmZmZmZmZmYpOwogICAgICAgIHB1dDMy
KDB4ZmZmZmZmZmYpOwogICAgICB9IGVsc2UgewogICAgICAgIGlmKHN5bV9iaXRtYXBzKXsKICAg
ICAgICAgIHdvcmRzW2EvMzJdICY9IH4oMSA8PCAoYSAlIDMyKSk7CiAgICAgICAgICAqKGludCop
KG9idWYgKyB3b3JkMGkgKyA0KihhLzMyKSkgPSBodG9ubCh3b3Jkc1thLzMyXSk7CiAgICAgICAg
fSBlbHNlIHsKICAgICAgICAgIHByaW50ZigidW5rbm93biByZXF1ZXN0ZWQgYXR0ciAlZFxuIiwg
YSk7CiAgICAgICAgICBwdXQ2NCgwKTsgLy8gWFhYCiAgICAgICAgfQogICAgICB9CiAgICB9CiAg
fQojaWYgMAogIGZvcihpbnQgaSA9IDA7IGkgPCAxNjsgaSsrKQogICAgcHV0MzIoMHhmZmZmZmZm
Zik7CiNlbmRpZgogICooaW50Kikob2J1ZitsZW5pKSA9IGh0b25sKG9pIC0gbGVuaSAtIDQpOwp9
Cgp2b2lkCnBhcnNlX29wX2dldGF0dHIoKQp7CiAgaW50IGJpdHdvcmRzID0gcGFyc2UzMigpOwog
IGludCB3b3Jkc1s0XTsKICBtZW1zZXQod29yZHMsIDAsIHNpemVvZih3b3JkcykpOwogIGlmKGJp
dHdvcmRzIDwgMSB8fCBiaXR3b3JkcyA+IDMpCiAgICBwcmludGYoInBhcnNlX29wX2dldGF0dHI6
IGNyYXp5IGJpdHdvcmRzICVkXG4iLCBiaXR3b3Jkcyk7CiAgZm9yKGludCBpID0gMDsgaSA8IGJp
dHdvcmRzICYmIGkgPCA0OyBpKyspCiAgICB3b3Jkc1tpXSA9IHBhcnNlMzIoKTsKICBwdXQzMigw
KTsgLy8gT0sKICBwdXRfZmF0dHI0KHdvcmRzLCBjdXJyZW50X2ZoKTsKfQoKdm9pZApwYXJzZV9v
cF9wdXRmaCgpCnsKICBjaGFyIGJ1Zls2NF07CiAgaW50IG4gPSBwYXJzZV9vcGFxdWUoYnVmKTsg
Ly8gZmgKICBpZihuICE9IDQpewogICAgcHJpbnRmKCJvcF9wdXRmaCBmaCBzaXplICVkLCBub3Qg
NFxuIiwgbik7CiAgICBleGl0KDEpOwogIH0KICBpbnQgZmggPSAqKGludCopYnVmOwogIGN1cnJl
bnRfZmggPSBmaDsKICBwdXQzMigwKTsgLy8gT0sKfQoKdm9pZApwYXJzZV9vcF9hY2Nlc3MoKQp7
CiAgaW50IG1hc2sgPSBwYXJzZTMyKCk7IC8vIG1hc2sgb2YgcmlnaHRzIHRvIHF1ZXJ5CiAgcHV0
MzIoMCk7IC8vIE9LCiAgcHV0MzIobWFzayk7IC8vIHN1cHBvcnRlZCA9IGFsbCByaWdodHMKICBw
dXQzMihtYXNrKTsgLy8gYWNjZXNzID0gYWxsIHJpZ2h0cwp9Cgp2b2lkCnBhcnNlX29wX2xvb2t1
cCgpCnsKICBjaGFyIG5hbWVbMjU2XTsKICBpbnQgbiA9IHBhcnNlX29wYXF1ZShuYW1lKTsKICBu
YW1lW24+PTA/bjowXSA9ICdcMCc7CiAgaW50IHhmaCA9IG5hbWUyZmgobmFtZSwgMCk7CiAgaWYo
eGZoIDwgMCl7CiAgICBwcmludGYoImxvb2t1cCAlcyAtPiBFTk9FTlRcbiIsIG5hbWUpOwogICAg
cHV0MzIoMik7IC8vIE5GUzRFUlJfTk9FTlQKICAgIGlmKGNvbXBvdW5kX3N0YXR1cyA9PSAwKQog
ICAgICBjb21wb3VuZF9zdGF0dXMgPSAyOwogIH0gZWxzZSB7CiAgICBwdXQzMigwKTsgLy8gT0sK
ICAgIGN1cnJlbnRfZmggPSB4Zmg7CiAgICBwcmludGYoImxvb2t1cCAlcyAtPiBmaCAlZFxuIiwg
bmFtZSwgY3VycmVudF9maCk7CiAgfQp9Cgp2b2lkCnBhcnNlX29wX2xvb2t1cHAoKQp7CiAgY3Vy
cmVudF9maCA9IDE7IC8vIC90bXAKICBwdXQzMigwKTsgLy8gT0sKfQoKdm9pZApwYXJzZV9vcF9y
ZWFkZGlyKCkKewogIGxvbmcgbG9uZyBjb29raWUgPSBwYXJzZTY0KCk7CiAgbG9uZyBsb25nIHZl
cmYgPSBwYXJzZTY0KCk7IC8vIGNvb2tpZSB2ZXJpZmllcgogIHBhcnNlMzIoKTsgLy8gZGlyY291
bnQKICBwYXJzZTMyKCk7IC8vIG1heGNvdW50CiAgLy8gYXR0cl9yZXF1ZXN0CiAgaW50IGJpdHdv
cmRzID0gcGFyc2UzMigpOwogIGludCB3b3Jkc1s0XTsKICBtZW1zZXQod29yZHMsIDAsIHNpemVv
Zih3b3JkcykpOwogIGZvcihpbnQgaSA9IDA7IGkgPCBiaXR3b3JkcyAmJiBpIDwgNDsgaSsrKQog
ICAgd29yZHNbaV0gPSBwYXJzZTMyKCk7CgogIHB1dDMyKDApOyAvLyBPSwogIHB1dDY0KHZlcmYp
OyAvLyBjb29raWV2ZXJmCiAgY2hhciAqbmFtZXNbXSA9IHsgInoiLCAienp6IiB9OwogIGZvcihp
bnQgaSA9IDA7IGkgPCAyOyBpKyspewogICAgcHV0MzIoMSk7IC8vICpuZXh0ZW50cnkKICAgIHB1
dDY0KG5leHRfY29va2llKyspOyAvLyBjb29raWUKICAgIHB1dF9vcGFxdWUoMywgbmFtZXNbaV0p
OyAvLyBuYW1lCiAgICBwdXRfZmF0dHI0KHdvcmRzLCBuYW1lMmZoKG5hbWVzW2ldLCAxKSk7CiAg
fQoKICBwdXQzMigwKTsgLy8gKm5leHRlbnRyeQoKICBwdXQzMigxKTsgLy8gZW9mCn0KCnZvaWQK
cGFyc2Vfb3Bfb3BlbigpCnsKICBjaGFyIG5hbWVbMjU2XTsKICBuYW1lWzBdID0gMDsKICBwYXJz
ZTMyKCk7IC8vIHNlcWlkCiAgcGFyc2UzMigpOyAvLyBzaGFyZV9hY2Nlc3MKICBwYXJzZTMyKCk7
IC8vIHNoYXJlX2RlbnkKICBwYXJzZTY0KCk7IC8vIG93bmVyIGNsaWVudCBpZAogIHBhcnNlX29w
YXF1ZSgwKTsgLy8gb3duZXIgb3duZXIKICAvLyBvcGVuZmxhZzQKICBpbnQgb3BlbnR5cGUgPSBw
YXJzZTMyKCk7CiAgaWYob3BlbnR5cGUgPT0gMSl7CiAgICAvLyBPUEVONF9DUkVBVEUKICAgIGlu
dCBtb2RlID0gcGFyc2UzMigpOyAvLyBjcmVhdGVob3c0CiAgICBpZihtb2RlID09IDApewogICAg
ICAvLyBVTkNIRUNLRUQ0CiAgICAgIC8vIGZhdHRyNCBjcmVhdGVhdHRycwogICAgICBpbnQgYml0
d29yZHMgPSBwYXJzZTMyKCk7CiAgICAgIGludCB3b3Jkc1szMl07CiAgICAgIGZvcihpbnQgaSA9
IDA7IGkgPCBiaXR3b3JkczsgaSsrKQogICAgICAgIHdvcmRzW2ldID0gcGFyc2UzMigpOwogICAg
ICBwYXJzZV9vcGFxdWUoMCk7IC8vIGF0dHJsaXN0NAogICAgfSBlbHNlIHsKICAgICAgcHJpbnRm
KCJPUEVONF9DUkVBVEUgdW5rbm93biBtb2RlICVkXG4iLCBtb2RlKTsKICAgICAgZXhpdCgxKTsK
ICAgIH0KICB9IGVsc2UgaWYob3BlbnR5cGUgPT0gMCl7CiAgICAvLyBPUEVONF9OT0NSRUFURQog
IH0gZWxzZSB7CiAgICBwcmludGYoInVua25vd24gb3BlbnR5cGUgJWRcbiIsIG9wZW50eXBlKTsK
ICAgIGV4aXQoMSk7CiAgfQogIGludCBvcGVuX2NsYWltX3R5cGUgPSBwYXJzZTMyKCk7CiAgaWYo
b3Blbl9jbGFpbV90eXBlID09IDApewogICAgLy8gQ0xBSU1fTlVMTAogICAgcGFyc2Vfb3BhcXVl
KG5hbWUpOyAvLyBmaWxlIG5hbWUKICB9IGVsc2UgaWYob3Blbl9jbGFpbV90eXBlID09IDIpewog
ICAgLy8gQ0xBSU1fREVMRUdBVEVfQ1VSCiAgICAvLyBvcGVuX2NsYWltX2RlbGVnYXRlX2N1cjQK
ICAgIC8vIHN0YXRlaWQ0CiAgICBwYXJzZTMyKCk7IC8vIHNlcWlkCiAgICBwYXJzZTMyKCk7CiAg
ICBwYXJzZTMyKCk7CiAgICBwYXJzZTMyKCk7CiAgICBwYXJzZV9vcGFxdWUobmFtZSk7IC8vIGZp
bGUgbmFtZQogIH0gZWxzZSBpZihvcGVuX2NsYWltX3R5cGUgPT0gNCl7CiAgICAvLyBDTEFJTV9G
SAogIH0gZWxzZSB7CiAgICBwcmludGYoIm95LCBvcGVuX2NsYWltX3R5cGUgJWRcbiIsIG9wZW5f
Y2xhaW1fdHlwZSk7CiAgICBleGl0KDEpOwogIH0KCiAgaW50IHhmaCA9IG5hbWUyZmgobmFtZSwg
b3BlbnR5cGUpOwogIGlmKHhmaCA8IDApewogICAgcHJpbnRmKCJvcGVuKCVzKSBFTk9FTlRcbiIs
IG5hbWUpOwogICAgcHV0MzIoMik7IC8vIE5GUzRFUlJfTk9FTlQKICB9IGVsc2UgewogICAgcHV0
MzIoMCk7IC8vIE9LCiAgICAvLyBzdGF0ZWlkNAogICAgcHV0MzIoMSk7IC8vIHNlcWlkCiAgICBw
dXQzMigxKTsgLy8gb3RoZXIKICAgIHB1dDMyKDEpOwogICAgcHV0MzIoMSk7CiAgICAvLyBjaGFu
Z2VfaW5mbzQKICAgIHB1dDMyKDEpOwogICAgcHV0NjQoMCk7IC8vIGJlZm9yZQogICAgcHV0NjQo
MCk7IC8vIGFmdGVyCiAgICBwdXQzMigwKTsgLy8gcmZsYWdzCiAgICBwdXQzMigwKTsgLy8gYXR0
cnNldCBiaXRtYXAgbGVuZ3RoCiAgICAvLyBvcGVuX2RlbGVnYXRpb240CiAgICBwdXQzMigwKTsg
Ly8gT1BFTl9ERUxFR0FURV9OT05FCiAgICBwcmludGYoIiAgbmFtZT0lc1xuIiwgbmFtZSk7CiAg
ICBpZihuYW1lWzBdKXsKICAgICAgY3VycmVudF9maCA9IHhmaDsKICAgIH0gZWxzZSB7CiAgICAg
IHByaW50Zigib3Bfb3Blbjogbm8gbmFtZSB3aXRoIHdoaWNoIHRvIHNldCBmaFxuIik7CiAgICB9
CiAgfQp9Cgp2b2lkCnBhcnNlX29wX3NldGF0dHIoKQp7CiAgLy8gc3RhdGVpZDQKICBwYXJzZTMy
KCk7IC8vIHNlcWlkCiAgcGFyc2UzMigpOyAvLyBvdGhlcgogIHBhcnNlMzIoKTsgLy8gb3RoZXIK
ICBwYXJzZTMyKCk7IC8vIG90aGVyCiAgLy8gZmF0dHI0CiAgaW50IGJpdHdvcmRzID0gcGFyc2Uz
MigpOwogIGludCB3b3Jkc1s2NF07CiAgZm9yKGludCBpID0gMDsgaSA8IGJpdHdvcmRzOyBpKysp
CiAgICB3b3Jkc1tpXSA9IHBhcnNlMzIoKTsKICBwYXJzZV9vcGFxdWUoMCk7IC8vIGF0dHJsaXN0
NAoKICBwdXQzMigwKTsgLy8gT0sKICBwdXQzMihiaXR3b3Jkcyk7CiAgZm9yKGludCBpID0gMDsg
aSA8IGJpdHdvcmRzOyBpKyspCiAgICBwdXQzMih3b3Jkc1tpXSk7Cn0KCnZvaWQKcGFyc2Vfb3Bf
bGF5b3V0Z2V0KCkKewogIHBhcnNlMzIoKTsgLy8gbG9nYV9zaWduYWxfbGF5b3V0X2F2YWlsCiAg
cGFyc2UzMigpOyAvLyBsYXlvdXR0eXBlNAogIHBhcnNlMzIoKTsgLy8gbGF5b3V0aW9tb2RlNAog
IHBhcnNlNjQoKTsgLy8gb2Zmc2V0CiAgcGFyc2U2NCgpOyAvLyBsZW5ndGgKICBwYXJzZTY0KCk7
IC8vIG1pbmxlbmd0aAogIHBhcnNlMzIoKTsgLy8gc3RhdGVpZDQgc2VxaWQKICBwYXJzZTMyKCk7
IC8vIHN0YXRlaWQ0IG90aGVyCiAgcGFyc2UzMigpOyAvLyBzdGF0ZWlkNCBvdGhlcgogIHBhcnNl
MzIoKTsgLy8gc3RhdGVpZDQgb3RoZXIKICBwYXJzZTMyKCk7IC8vIGNvdW50MzIKICAKICBwdXQz
MigwKTsgLy8gT0sKICBwdXQzMigwKTsgLy8gcmV0dXJuX29uX2Nsb3NlCiAgcHV0MzIoMCk7IC8v
IHN0YXRlaWQ0IHNlcWlkCiAgcHV0MzIoMCk7IC8vIHN0YXRlaWQ0IG90aGVyCiAgcHV0MzIoMCk7
IC8vIHN0YXRlaWQ0IG90aGVyCiAgcHV0MzIoMCk7IC8vIHN0YXRlaWQ0IG90aGVyCiAgcHV0MzIo
MSk7IC8vICMgb2YgbGF5b3V0NAogIHB1dDY0KDApOyAvLyBvZmZzZXQKICBwdXQ2NCgxMDAwMDAw
KTsgLy8gbGVuZ3RoCiAgcHV0MzIoMyk7IC8vIGxheW91dGlvbW9kZTQKICBwdXQzMigxKTsgLy8g
bGF5b3V0dHlwZTQKICBwdXRfb3BhcXVlKDgsICJ4eHh4eHh4eCIpOyAvLyBsb2NfYm9keQp9Cgp2
b2lkCnBhcnNlX29wX3dyaXRlKCkKewogIHBhcnNlMzIoKTsgLy8gc3RhdGVpZDQKICBwYXJzZTMy
KCk7IC8vIHN0YXRlaWQ0CiAgcGFyc2UzMigpOyAvLyBzdGF0ZWlkNAogIHBhcnNlMzIoKTsgLy8g
c3RhdGVpZDQKICBwYXJzZTY0KCk7IC8vIG9mZnNldAogIHBhcnNlMzIoKTsgLy8gc3RhYmxlX2hv
dzQKICBpbnQgbiA9IHBhcnNlX29wYXF1ZSgwKTsgLy8gZGF0YQoKICBwdXQzMigwKTsgLy8gT0sK
ICBwdXQzMihuKTsgLy8gY291bnQKICBwdXQzMigwKTsgLy8gVU5TVEFCTEU0CiAgcHV0NjQoMSk7
IC8vIHZlcmlmaWVyCn0KCnZvaWQKcGFyc2Vfb3BfcmVhZCgpCnsKICBwYXJzZTMyKCk7IC8vIHN0
YXRlaWQ0CiAgcGFyc2UzMigpOyAvLyBzdGF0ZWlkNAogIHBhcnNlMzIoKTsgLy8gc3RhdGVpZDQK
ICBwYXJzZTMyKCk7IC8vIHN0YXRlaWQ0CiAgcGFyc2U2NCgpOyAvLyBvZmZzZXQKICBwYXJzZTMy
KCk7IC8vIGNvdW50CgogIHB1dDMyKDApOyAvLyBPSwogIHB1dDMyKDEpOyAvLyBlb2YKICBwdXRf
b3BhcXVlKDQsICJhYmNkIik7Cn0KCnZvaWQKcGFyc2Vfb3BfY29tbWl0KCkKewogIHBhcnNlNjQo
KTsgLy8gb2Zmc2V0CiAgcGFyc2UzMigpOyAvLyBjb3VudAogIHB1dDMyKDApOyAvLyBPSwogIHB1
dDY0KDEpOyAvLyB2ZXJpZmllcjQKfQoKdm9pZApwYXJzZV9vcF9jbG9zZSgpCnsKICBwYXJzZTMy
KCk7IC8vIHNlcWlkCiAgcGFyc2UzMigpOyAvLyBzdGF0ZWlkNC5zZXFpZAogIHBhcnNlMzIoKTsg
Ly8gc3RhdGVpZDQub3RoZXIKICBwYXJzZTMyKCk7IC8vIHN0YXRlaWQ0Lm90aGVyCiAgcGFyc2Uz
MigpOyAvLyBzdGF0ZWlkNC5vdGhlcgogIHB1dDMyKDApOyAvLyBPSwogIHB1dDMyKDIpOyAvLyBz
ZXFpZAogIHB1dDMyKDEpOyAvLyBvdGhlcgogIHB1dDMyKDEpOwogIHB1dDMyKDEpOwp9Cgp2b2lk
CnBhcnNlX29wX2NyZWF0ZSgpCnsKICBpbnQgdHlwZSA9IHBhcnNlMzIoKTsgLy8gdHlwZQogIGNo
YXIgbmFtZVsxMjhdOwogIG1lbXNldChuYW1lLCAwLCBzaXplb2YobmFtZSkpOwogIGludCBuYW1l
bGVuID0gcGFyc2Vfb3BhcXVlKG5hbWUpOwogIC8vIGZhdHRyNAogIGludCBiaXR3b3JkcyA9IHBh
cnNlMzIoKTsKICBpbnQgd29yZHNbNjRdOwogIGZvcihpbnQgaSA9IDA7IGkgPCBiaXR3b3Jkczsg
aSsrKQogICAgd29yZHNbaV0gPSBwYXJzZTMyKCk7CiAgcGFyc2Vfb3BhcXVlKDApOyAvLyBhdHRy
bGlzdDQKICBwcmludGYoImNyZWF0ZSB0eXBlPSVkIG5hbWU9JXNcbiIsIHR5cGUsIG5hbWUpOwoK
ICBjdXJyZW50X2ZoID0gbmFtZTJmaChuYW1lLCAxKTsKICBwdXQzMigwKTsgLy8gT0sKICBwdXQz
MigxKTsgLy8gY2hhbmdlX2luZm80LmF0b21pYwogIHB1dDY0KDEpOyAvLyBiZWZvcmUKICBwdXQ2
NCgyKTsgLy8gYWZ0ZXIKICBwdXQzMihiaXR3b3Jkcyk7CiAgZm9yKGludCBpID0gMDsgaSA8IGJp
dHdvcmRzOyBpKyspCiAgICBwdXQzMih3b3Jkc1tpXSk7Cn0KCnZvaWQKcGFyc2Vfb3BfcmVtb3Zl
KCkKewogIGNoYXIgbmFtZVsyNTZdOwogIG1lbXNldChuYW1lLCAwLCBzaXplb2YobmFtZSkpOwog
IGludCBuYW1lbGVuID0gcGFyc2Vfb3BhcXVlKG5hbWUpOwogIHB1dDMyKDApOyAvLyBPSwogIHB1
dDMyKDEpOyAvLyBjaGFuZ2VfaW5mbzQuYXRvbWljCiAgcHV0NjQoMSk7IC8vIGJlZm9yZQogIHB1
dDY0KDIpOyAvLyBhZnRlcgp9CgppbnQgc2F2ZWRfZmg7Cgp2b2lkCnBhcnNlX29wX3NhdmVmaCgp
CnsKICBzYXZlZF9maCA9IGN1cnJlbnRfZmg7CiAgcHV0MzIoMCk7IC8vIE9LCn0KCnZvaWQKcGFy
c2Vfb3BfcmVzdG9yZWZoKCkKewogIGN1cnJlbnRfZmggPSBzYXZlZF9maDsKICBwdXQzMigwKTsg
Ly8gT0sKfQoKdm9pZApwYXJzZV9vcF9yZW5hbWUoKQp7CiAgY2hhciBuYW1lMVsyNTZdLCBuYW1l
MlsyNTZdOwogIG1lbXNldChuYW1lMSwgMCwgc2l6ZW9mKG5hbWUxKSk7CiAgbWVtc2V0KG5hbWUy
LCAwLCBzaXplb2YobmFtZTIpKTsKICBwYXJzZV9vcGFxdWUobmFtZTEpOwogIHBhcnNlX29wYXF1
ZShuYW1lMik7CiAgcHJpbnRmKCJyZW5hbWUgJXMgJXNcbiIsIG5hbWUxLCBuYW1lMik7CgogIHB1
dDMyKDApOyAvLyBPSwogIC8vIGNoYW5nZV9pbmZvNAogIHB1dDMyKDEpOwogIHB1dDY0KDEpOyAv
LyBiZWZvcmUKICBwdXQ2NCgyKTsgLy8gYWZ0ZXIKICAvLyBjaGFuZ2VfaW5mbzQKICBwdXQzMigx
KTsKICBwdXQ2NCgzKTsgLy8gYmVmb3JlCiAgcHV0NjQoNCk7IC8vIGFmdGVyCn0KCnZvaWQKcGFy
c2Vfb3Bfc2VlaygpCnsKICAvLyBzdGF0ZWlkNAogIHBhcnNlMzIoKTsgLy8gc2VxaWQKICBwYXJz
ZTMyKCk7CiAgcGFyc2UzMigpOwogIHBhcnNlMzIoKTsKICBsb25nIG9mZnNldCA9IHBhcnNlNjQo
KTsgLy8gb2Zmc2V0CiAgaW50IHdoYXQgPSBwYXJzZTMyKCk7CiAgcHJpbnRmKCJzZWVrIG9mZnNl
dD0lbGQgd2hhdD0lZFxuIiwgb2Zmc2V0LCB3aGF0KTsKICBwdXQzMigwKTsgLy8gT0sKICBpZih3
aGF0ID09IDApewogICAgLy8gbmV4dCBkYXRhPwogICAgaWYob2Zmc2V0ID49IDMyKXsKICAgICAg
cHV0MzIoMSk7CiAgICAgIHB1dDY0KG9mZnNldCk7CiAgICB9IGVsc2UgewogICAgICBwdXQzMigw
KTsKICAgICAgcHV0NjQob2Zmc2V0ICsgMSk7CiAgICB9CiAgfSBlbHNlIHsKICAgIC8vIG5leHQg
aG9sZT8KICAgIGlmKG9mZnNldCA+PSAzMil7CiAgICAgIHB1dDMyKDEpOwogICAgICBwdXQ2NChv
ZmZzZXQpOwogICAgfSBlbHNlIHsKICAgICAgcHV0MzIoMCk7CiAgICAgIHB1dDY0KDMyKTsKICAg
IH0KICB9Cn0KCnZvaWQKcGFyc2Vfb3BfY29weSgpCnsKICAvLyBzdGF0ZWlkNAogIHBhcnNlMzIo
KTsgLy8gc2VxaWQKICBwYXJzZTMyKCk7CiAgcGFyc2UzMigpOwogIHBhcnNlMzIoKTsKICAvLyBz
dGF0ZWlkNAogIHBhcnNlMzIoKTsgLy8gc2VxaWQKICBwYXJzZTMyKCk7CiAgcGFyc2UzMigpOwog
IHBhcnNlMzIoKTsKICBwYXJzZTY0KCk7IC8vIG9mZnNldAogIHBhcnNlNjQoKTsgLy8gb2Zmc2V0
CiAgbG9uZyBsb25nIGNvdW50ID0gcGFyc2U2NCgpOyAvLyBjb3VudAogIHBhcnNlMzIoKTsgLy8g
Y29uc2VjdXRpdmUKICBwYXJzZTMyKCk7IC8vIHN5bmNocm9ub3VzCiAgaW50IG5sb2MgPSBwYXJz
ZTMyKCk7CiAgZm9yKGludCBpID0gMDsgaSA8IG5sb2M7IGkrKyl7CiAgICBpbnQgdHlwZSA9IHBh
cnNlMzIoKTsKICAgIGlmKHR5cGUgPT0gMSB8fCB0eXBlID09IDIpewogICAgICBwYXJzZV9vcGFx
dWUoMCk7IC8vIG5hbWUgb2YgdXJsCiAgICB9IGVsc2UgewogICAgICBwYXJzZV9vcGFxdWUoMCk7
IC8vIG5ldHdvcmsgaWQKICAgICAgcGFyc2Vfb3BhcXVlKDApOyAvLyB1bml2ZXJzYWwgYWRkcmVz
cwogICAgfQogIH0KCiAgcHV0MzIoMCk7IC8vIE9LCiAgLy8gc3RhdGVpZDQgY2FsbGJhY2tfaWQ8
MT4KICBpZigxKXsKICAgIHB1dDMyKDApOyAvLyBuCiAgfSBlbHNlIHsKICAgIHB1dDMyKDEpOyAv
LyBuCiAgICBwdXQzMigxKTsgLy8gc2VxaWQKICAgIHB1dDMyKDEpOyAvLyBvdGhlcgogICAgcHV0
MzIoMSk7CiAgICBwdXQzMigxKTsKICB9CiAgcHV0NjQoY291bnQpOyAvLyBjb3VudAogIHB1dDMy
KDApOyAvLyBzdGFibGVfaG93IFVOU1RBQkxFCiAgcHV0NjQoMCk7IC8vIHZlcmlmaWVyCiAgcHV0
MzIoMSk7IC8vIGNvbnNlY3V0aXZlCiAgcHV0MzIoMSk7IC8vIHN5bmNocm9ub3VzCn0KCnZvaWQK
cGFyc2Vfb3BfbG9jaygpCnsKICBwYXJzZTMyKCk7IC8vIGxvY2sgdHlwZQogIHBhcnNlMzIoKTsg
Ly8gcmVjbGFpbQogIHBhcnNlNjQoKTsgLy8gb2Zmc2V0CiAgcGFyc2U2NCgpOyAvLyBsZW5ndGgK
ICBpbnQgb3duZXIgPSBwYXJzZTMyKCk7IC8vIGxvY2s0IG5ld19sb2NrX293bmVyCiAgaWYob3du
ZXIpewogICAgcGFyc2UzMigpOyAvLyBvcGVuX3NlcWlkCiAgICAvLyBzdGF0ZWlkNAogICAgcGFy
c2UzMigpOyAvLyBzZXFpZAogICAgcGFyc2UzMigpOwogICAgcGFyc2UzMigpOwogICAgcGFyc2Uz
MigpOwogICAgcGFyc2UzMigpOyAvLyBsb2NrX3NlcWlkCiAgICBwYXJzZTY0KCk7IC8vIGNsaWVu
dGlkCiAgICBwYXJzZV9vcGFxdWUoMCk7IC8vIG93bmVyCiAgfSBlbHNlIHsKICAgIC8vIHN0YXRl
aWQ0CiAgICBwYXJzZTMyKCk7IC8vIHNlcWlkCiAgICBwYXJzZTMyKCk7CiAgICBwYXJzZTMyKCk7
CiAgICBwYXJzZTMyKCk7CiAgICBwYXJzZTMyKCk7IC8vIHNlcWlkCiAgfQoKICBwdXQzMigwKTsg
Ly8gT0sKICAvLyBzdGF0ZWlkNAogIHB1dDMyKDEpOyAvLyBzZXFpZAogIHB1dDMyKDEpOyAvLyBv
dGhlcgogIHB1dDMyKDEpOwogIHB1dDMyKDEpOwoKICBzZW5kX2JhY2sgPSAxOwp9Cgp2b2lkCnBh
cnNlX29wX2xvY2t1KCkKewogIHBhcnNlMzIoKTsgLy8gbG9jayB0eXBlCiAgcGFyc2UzMigpOyAv
LyBzZXFpZAogIC8vIHN0YXRlaWQ0CiAgcGFyc2UzMigpOyAvLyBzZXFpZAogIHBhcnNlMzIoKTsK
ICBwYXJzZTMyKCk7CiAgcGFyc2UzMigpOwogIHBhcnNlNjQoKTsgLy8gb2Zmc2V0CiAgcGFyc2U2
NCgpOyAvLyBsZW5ndGgKCiAgcHV0MzIoMCk7IC8vIE9LCiAgLy8gc3RhdGVpZDQKICBwdXQzMigx
KTsgLy8gc2VxaWQKICBwdXQzMigxKTsgLy8gb3RoZXIKICBwdXQzMigxKTsKICBwdXQzMigxKTsK
fQoKdm9pZApwYXJzZV9vcF9mcmVlX3N0YXRlaWQoKQp7CiAgLy8gc3RhdGVpZDQKICBwYXJzZTMy
KCk7IC8vIHNlcWlkCiAgcGFyc2UzMigpOwogIHBhcnNlMzIoKTsKICBwYXJzZTMyKCk7CgogIHB1
dDMyKDApOyAvLyBPSwp9Cgp2b2lkCnBhcnNlX2NvbXBvdW5kKCkKewogIGNoYXIgdGFnWzUxMl07
CiAgaW50IHRhZ2xlbiA9IHBhcnNlX29wYXF1ZSh0YWcpOyAvLyB0YWcKICBwYXJzZTMyKCk7IC8v
IGNsaWVudCBtaW5vciB2ZXJzaW9uCiAgaW50IG5vcHMgPSBwYXJzZTMyKCk7CgogIC8vIHN0YXJ0
IGEgQ09NUE9VTkQ0cmVzCiAgaW50IHN0YXR1c19vaSA9IG9pOwogIGNvbXBvdW5kX3N0YXR1cyA9
IDA7CiAgcHV0MzIoY29tcG91bmRfc3RhdHVzKTsgLy8gcGxhY2UtaG9sZGVyCiAgcHV0X29wYXF1
ZSh0YWdsZW4sIHRhZyk7CiAgcHV0MzIobm9wcyk7IC8vIGxlbmd0aCBvZiByZXNhcnJheTw+CiAg
CiAgaW50IG9waW5kZXggPSAwOwogIGZvcihvcGluZGV4ID0gMDsgb3BpbmRleCA8IG5vcHMgJiYg
aWkgPCBpbGVuOyBvcGluZGV4KyspewogICAgaW50IG9wID0gcGFyc2UzMigpOwogICAgcHJpbnRm
KCJvcCAlZCAjJWRcbiIsIG9wLCBvcGNvdW50c1tvcCYweGZmXSk7CiAgICBwdXQzMihvcCk7IC8v
IHJlc29wIGluIG5mc19yZXNvcDQKICAgIGlmKHN5bV9vcCA9PSBvcCl7CiAgICAgIGlmKHN5bV9z
a2lwIDw9IDApewogICAgICAgIHN5bXN0YXJ0ID0gb2k7CiAgICAgIH0KICAgICAgc3ltX3NraXAg
LT0gMTsKICAgIH0KICAgIGlmKG9wID09IDQyKXsKICAgICAgcGFyc2Vfb3BfZXhjaGFuZ2VfaWQo
KTsKICAgIH0gZWxzZSBpZihvcCA9PSA0Myl7CiAgICAgIHBhcnNlX29wX2NyZWF0ZV9zZXNzaW9u
KCk7CiAgICB9IGVsc2UgaWYob3AgPT0gNTMpewogICAgICBwYXJzZV9vcF9zZXF1ZW5jZSgpOwog
ICAgfSBlbHNlIGlmKG9wID09IDU4KXsKICAgICAgcGFyc2Vfb3BfcmVjbGFpbV9jb21wbGV0ZSgp
OwogICAgfSBlbHNlIGlmKG9wID09IDI0KXsKICAgICAgcGFyc2Vfb3BfcHV0cm9vdGZoKCk7CiAg
ICB9IGVsc2UgaWYob3AgPT0gNTIpewogICAgICBwYXJzZV9vcF9zZWNpbmZvX25vX25hbWUoKTsK
ICAgIH0gZWxzZSBpZihvcCA9PSA0NCl7CiAgICAgIHBhcnNlX29wX2Rlc3Ryb3lfc2Vzc2lvbigp
OwogICAgfSBlbHNlIGlmKG9wID09IDU3KXsKICAgICAgcGFyc2Vfb3BfZGVzdHJveV9jbGllbnRp
ZCgpOwogICAgfSBlbHNlIGlmKG9wID09IDEwKXsKICAgICAgcGFyc2Vfb3BfZ2V0ZmgoKTsKICAg
IH0gZWxzZSBpZihvcCA9PSA5KXsKICAgICAgcGFyc2Vfb3BfZ2V0YXR0cigpOwogICAgfSBlbHNl
IGlmKG9wID09IDIyKXsKICAgICAgcGFyc2Vfb3BfcHV0ZmgoKTsKICAgIH0gZWxzZSBpZihvcCA9
PSAzKXsKICAgICAgcGFyc2Vfb3BfYWNjZXNzKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gMTUpewog
ICAgICBwYXJzZV9vcF9sb29rdXAoKTsKICAgIH0gZWxzZSBpZihvcCA9PSAxNil7CiAgICAgIHBh
cnNlX29wX2xvb2t1cHAoKTsKICAgIH0gZWxzZSBpZihvcCA9PSAyNil7CiAgICAgIHBhcnNlX29w
X3JlYWRkaXIoKTsKICAgIH0gZWxzZSBpZihvcCA9PSAxOCl7CiAgICAgIHBhcnNlX29wX29wZW4o
KTsKICAgIH0gZWxzZSBpZihvcCA9PSA0NSl7CiAgICAgIHBhcnNlX29wX2ZyZWVfc3RhdGVpZCgp
OwogICAgfSBlbHNlIGlmKG9wID09IDEyKXsKICAgICAgcGFyc2Vfb3BfbG9jaygpOwogICAgfSBl
bHNlIGlmKG9wID09IDE0KXsKICAgICAgcGFyc2Vfb3BfbG9ja3UoKTsKICAgIH0gZWxzZSBpZihv
cCA9PSA2KXsKICAgICAgcGFyc2Vfb3BfY3JlYXRlKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gMjgp
ewogICAgICBwYXJzZV9vcF9yZW1vdmUoKTsKICAgIH0gZWxzZSBpZihvcCA9PSA0KXsKICAgICAg
cGFyc2Vfb3BfY2xvc2UoKTsKICAgIH0gZWxzZSBpZihvcCA9PSAzNCl7CiAgICAgIHBhcnNlX29w
X3NldGF0dHIoKTsKICAgIH0gZWxzZSBpZihvcCA9PSA1MCl7CiAgICAgIHBhcnNlX29wX2xheW91
dGdldCgpOwogICAgfSBlbHNlIGlmKG9wID09IDM4KXsKICAgICAgcGFyc2Vfb3Bfd3JpdGUoKTsK
ICAgIH0gZWxzZSBpZihvcCA9PSAyNSl7CiAgICAgIHBhcnNlX29wX3JlYWQoKTsKICAgIH0gZWxz
ZSBpZihvcCA9PSA1KXsKICAgICAgcGFyc2Vfb3BfY29tbWl0KCk7CiAgICB9IGVsc2UgaWYob3Ag
PT0gMzIpewogICAgICBwYXJzZV9vcF9zYXZlZmgoKTsKICAgIH0gZWxzZSBpZihvcCA9PSAzMSl7
CiAgICAgIHBhcnNlX29wX3Jlc3RvcmVmaCgpOwogICAgfSBlbHNlIGlmKG9wID09IDI5KXsKICAg
ICAgcGFyc2Vfb3BfcmVuYW1lKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gNjkpewogICAgICBwYXJz
ZV9vcF9zZWVrKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gNjApewogICAgICBwYXJzZV9vcF9jb3B5
KCk7CiAgICB9IGVsc2UgewogICAgICBwcmludGYoInVua25vd24gb3AgJWRcbiIsIG9wKTsKICAg
ICAgLy8gY2Fubm90IGNvbnRpbnVlIHRvIHRoZSBuZXh0IG9wIHNpbmNlCiAgICAgIC8vIHdlIGRv
bid0IGtub3cgaG93IGxvbmcgdGhpcyBvbmUgaXMuCiAgICAgIGJyZWFrOwogICAgfQogICAgb3Bj
b3VudHNbb3AmMHhmZl0gKz0gMTsKICB9CiAgKihpbnQqKShvYnVmK3N0YXR1c19vaSkgPSBodG9u
bChjb21wb3VuZF9zdGF0dXMpOwogIGlmKG9waW5kZXggIT0gbm9wcykKICAgIHByaW50ZigiY29t
cG91bmQgd2l0aCAlZCBub3BzIGJ1dCBvbmx5IGVub3VnaCBieXRlcyBmb3IgJWRcbiIsIG5vcHMs
IG9waW5kZXgpOwogIGlmKGlpICE9IGlsZW4pCiAgICBwcmludGYoImNvbXBvdW5kIGNvbnN1bWVk
IG9ubHkgJWQgb2YgJWQgYnl0ZXNcbiIsIGlpLCBpbGVuKTsKfQoKdm9pZApwYXJzZV9ycGMoKQp7
CiAgLy8gU1VOIFJQQwogIGludCB4aWQgPSBwYXJzZTMyKCk7CiAgaW50IG10eXBlID0gcGFyc2Uz
MigpOyAvLyBtdHlwZSwgMD1DQUxMLCAxPVJFUExZCiAgaWYobXR5cGUgPT0gMSl7CiAgICAvLyBy
cGMgcmVwbHkKICAgIGludCBzdGF0MCA9IHBhcnNlMzIoKTsgLy8gTVNHX0FDQ0VQVEVECiAgICBp
bnQgZmxhdm9yID0gcGFyc2UzMigpOwogICAgcGFyc2Vfb3BhcXVlKDApOyAvLyB2ZXJmCiAgICBp
bnQgc3RhdDEgPSBwYXJzZTMyKCk7IC8vIHN0YXR1cwogICAgaW50IHN0YXQyID0gcGFyc2UzMigp
OyAvLyBzdGF0dXMKICAgIHBhcnNlX29wYXF1ZSgwKTsKICAgIGludCBub3BzID0gcGFyc2UzMigp
OwogICAgaW50IG9wID0gcGFyc2UzMigpOwogICAgcHJpbnRmKCJnb3QgYSBiYWNrY2hhbm5lbCBy
ZXBseSwgc3RhdCAlZCAlZCwgbm9wcyAlZCBvcDEgJWRcbiIsIHN0YXQxLCBzdGF0Miwgbm9wcywg
b3ApOwogICAgLy8gcHJpbnRmKCJnb3QgYSBiYWNrY2hhbm5lbCByZXBseVxuIik7CiAgICByZXR1
cm47CiAgfQogIHBhcnNlMzIoKTsgLy8gcnBjIHZlcnNpb24KICBwYXJzZTMyKCk7IC8vIHByb2cj
CiAgcGFyc2UzMigpOyAvLyBwcm9nIHZlcnMKICBpbnQgcHJvYyA9IHBhcnNlMzIoKTsKICBwYXJz
ZTMyKCk7IC8vIGNyZWQgdHlwZQogIHBhcnNlX29wYXF1ZSgwKTsgLy8gY3JlZAogIHBhcnNlMzIo
KTsgLy8gdmVyZiB0eXBlCiAgcGFyc2Vfb3BhcXVlKDApOyAvLyB2ZXJmCgogIHB1dDMyKHhpZCk7
CiAgcHV0MzIoMSk7IC8vIFJFUExZCiAgcHV0MzIoMCk7IC8vIE1TR19BQ0NFUFRFRAogIHB1dDMy
KDApOyAvLyBvcGFxdWVfYXV0aCBmbGF2b3IgPSBBVVRIX05VTEwKICBwdXQzMigwKTsgLy8gb3Bh
cXVlX2F1dGggbGVuZ3RoCiAgcHV0MzIoMCk7IC8vIFNVQ0NFU1MKCiAgaWYocHJvYyA9PSAwKXsK
ICAgIHBhcnNlX25vcCgpOwogIH0gZWxzZSBpZihwcm9jID09IDEpewogICAgcGFyc2VfY29tcG91
bmQoKTsKICB9IGVsc2UgewogICAgcHJpbnRmKCJ1bmtub3duIHJwYyBwcm9jICVkXG4iLCBwcm9j
KTsKICB9Cn0KCnZvaWQKcHV0X3JwY19oZWFkZXIoaW50IHByb2csIGludCBwcm9jKQp7CiAgaW50
IHhpZCA9IDE7CiAgcHV0MzIoeGlkKyspOwogIHB1dDMyKDApOyAvLyBtdHlwZT1DQUxMCiAgcHV0
MzIoMik7IC8vIHJwYyB2ZXJzaW9uCiAgcHV0MzIocHJvZyk7IC8vIHByb2cgIyAtLSBuZnMgdjQg
Y2FsbGJhY2sKICBwdXQzMigxKTsgLy8gcHJvZyB2ZXJzCiAgcHV0MzIocHJvYyk7IC8vIHByb2MK
ICBpZihwcm9jID09IDApewogICAgcHV0MzIoMCk7IC8vIGNyZWQgdHlwZQogICAgcHV0MzIoMCk7
IC8vIGNyZWQgbGVuCiAgfSBlbHNlIHsKICAgIHB1dDMyKDEpOyAvLyBjcmVkIHR5cGUgQVVUSF9T
WVMgLyBBVVRIX1VOSVgKICAgIHB1dDMyKDMyKTsgLy8gY3JlZCBsZW5ndGgKICAgIHB1dDMyKDAp
OyAvLyBzdGFtcAogICAgcHV0X29wYXF1ZSg5LCAibG9jYWxob3N0Iik7CiAgICBwdXQzMig2NTUz
NCk7IC8vIHVpZAogICAgcHV0MzIoNjU1MzQpOyAvLyBnaWQKICAgIHB1dDMyKDApOyAvLyAjIGdp
ZHMKICB9CiAgcHV0MzIoMCk7IC8vIHZlcmYgdHlwZQogIHB1dDMyKDApOyAvLyB2ZXJmIGxlbgp9
Cgp2b2lkCnN5cyhjb25zdCBjaGFyICpjbWQpCnsKICB2b2xhdGlsZSBpbnQgeCA9IHN5c3RlbShj
bWQpOwogICh2b2lkKSB4Owp9CgppbnQKbWFpbigpewogIHNldGxpbmVidWYoc3Rkb3V0KTsKICBz
dHJ1Y3QgcmxpbWl0IHI7CiAgci5ybGltX2N1ciA9IHIucmxpbV9tYXggPSAwOwogIHNldHJsaW1p
dChSTElNSVRfQ09SRSwgJnIpOwoKICBpbnQgcyA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVB
TSwgMCk7CiAgc3RydWN0IHNvY2thZGRyX2luIHNpbjsKICBtZW1zZXQoJnNpbiwgMCwgc2l6ZW9m
KHNpbikpOwogIHNpbi5zaW5fZmFtaWx5ID0gQUZfSU5FVDsKICBzaW4uc2luX3BvcnQgPSBodG9u
cygyMDQ5KTsKICBpbnQgeWVzID0gMTsKICBzZXRzb2Nrb3B0KHMsIFNPTF9TT0NLRVQsIFNPX1JF
VVNFQUREUiwgJnllcywgc2l6ZW9mKHllcykpOwogIGlmKGJpbmQocywgKHN0cnVjdCBzb2NrYWRk
ciAqKSZzaW4sIHNpemVvZihzaW4pKSA8IDApewogICAgcGVycm9yKCJiaW5kIik7IGV4aXQoMSk7
CiAgfQogIGxpc3RlbihzLCAxMCk7CiAgc3luYygpOwoKICBpbnQgcGlkMSA9IGZvcmsoKTsKICBp
ZihwaWQxID09IDApewogICAgY2xvc2Uocyk7CiAgICBzbGVlcCgxKTsKICAgIGlmKHN5c3RlbSgi
ZWNobyAtbiBtb3VudDogOyBtb3VudCAtbyBub2xvY2ssbm9kZXYgMTI3LjAuMC4xOi90bXAgL21u
dCIpID09IDApewogICAgICBpZigwKXsKICAgICAgICBwcmludGYoInN0YXRmczogIik7IGZmbHVz
aChzdGRvdXQpOwogICAgICAgIHN0cnVjdCBzdGF0ZnMgc2I7CiAgICAgICAgaW50IHJldCA9IHN0
YXRmcygiL21udC8uIiwgJnNiKTsKICAgICAgICBwcmludGYoInN0YXRmcyAtPiAlZFxuIiwgcmV0
KTsKICAgICAgfQogICAgICBpZigwKXsKICAgICAgICBpbnQgZmQgPSBvcGVuKCIvbW50IiwgMCk7
CiAgICAgICAgaWYoZmQgPCAwKSB7IHBlcnJvcigiL21udCIpOyBleGl0KDEpOyB9CiAgICAgICAg
b2ZmX3QgYmFzZSA9IDA7CiAgICAgICAgY2hhciBidWZbNDA5Nl07CiAgICAgICAgc3NpemVfdCBy
ZXQgPSBnZXRkaXJlbnRyaWVzKGZkLCBidWYsIHNpemVvZihidWYpLCAmYmFzZSk7CiAgICAgICAg
cHJpbnRmKCJnZXRkaXJlbnRyaWVzIHJldCAlbGQgZXJybm8gJWRcbiIsIHJldCwgZXJybm8pOwog
ICAgICAgIGlmKHJldCA8IDApIHBlcnJvcigiZ2V0ZGlyZW50cmllcyIpOwogICAgICAgIGNsb3Nl
KGZkKTsKICAgICAgfQogICAgICBpZigxKXsKICAgICAgICBpbnQgZmQgPSBvcGVuKCIvbW50L3gi
LCAwKTsKICAgICAgICBwcmludGYoIm9wZW4gL21udC94IC0+ICVkIGVycm5vICVkXG4iLCBmZCwg
ZXJybm8pOwogICAgICAgIGlmKGZkIDwgMCkgcGVycm9yKCIvbW50L3giKTsKICAgICAgICBjbG9z
ZShmZCk7CiAgICAgIH0KICAgICAgaWYoMCl7CiAgICAgICAgaW50IGZkID0gb3BlbigiL21udC9u
ZXciLCBPX1JEV1J8T19DUkVBVCwgMDY2Nik7CiAgICAgICAgcHJpbnRmKCJjcmVhdCAvbW50L25l
dyAtPiAlZCBlcnJubyAlZFxuIiwgZmQsIGVycm5vKTsKICAgICAgICBpZihmZCA8IDApIHBlcnJv
cigiL21udC9uZXciKTsKICAgICAgICBpZih3cml0ZShmZCwgIngiLCAxKSA8IDApIHBlcnJvcigi
d3JpdGUiKTsKICAgICAgICBsc2VlayhmZCwgMEwsIDApOwogICAgICAgIGNoYXIgYnVmWzUxMl07
CiAgICAgICAgdm9sYXRpbGUgaW50IGp1bmsgPSByZWFkKGZkLCBidWYsIHNpemVvZihidWYpKTsK
ICAgICAgICAodm9pZCkganVuazsKICAgICAgICAvL21rZGlyKCIvbW50L25ldy9uZXduZXciLCAw
Nzc3KTsKICAgICAgICAvL2lmKHVubGluaygiL21udC9uZXciKSA8IDApIHBlcnJvcigidW5saW5r
Iik7CiAgICAgICAgLy9jbG9zZShmZCk7CiAgICAgICAgaWYoZmxvY2soZmQsIExPQ0tfRVgpIDwg
MCkgcGVycm9yKCJmbG9jayIpOwogICAgICAgIHNsZWVwKDEpOwogICAgICB9CiAgICAgIGlmKDAp
ewogICAgICAgIGludCByZXQgPSBta2RpcigiL21udC9kIiwgMDc3Nyk7CiAgICAgICAgcHJpbnRm
KCJta2RpciAvbW50L2QgLT4gJWQgZXJybm8gJWRcbiIsIHJldCwgZXJybm8pOwogICAgICAgIGlm
KHJldCA8IDApIHBlcnJvcigibWtkaXIgL21udC9kIik7CiAgICAgICAgaWYoY2hkaXIoIi9tbnQv
ZCIpID09IDApewogICAgICAgICAgcHJpbnRmKCJjaGRpciBzdWNjZWVkZWRcbiIpOwogICAgICAg
ICAgaWYoY3JlYXQoIm5ld25ld25ldyIsIDA2NjYpIDwgMCkgcGVycm9yKCJjcmVhdGUgbmV3bmV3
bmV3Iik7CiAgICAgICAgICB1bmxpbmsoIm5ld25ld25ldyIpOwogICAgICAgIH0gZWxzZSB7CiAg
ICAgICAgICBwZXJyb3IoImNoZGlyIC9tbnQvZCIpOwogICAgICAgIH0KICAgICAgICBjcmVhdCgi
L21udC9kL25ld25ldyIsIDA2NjYpOwogICAgICAgIHJtZGlyKCIvbW50L2QiKTsKICAgICAgfQog
ICAgICBpZigwKXsKICAgICAgICBzeXMoInNldGZhY2wgLW0gb3duZXJAOnJ3eHA6OmFsbG93IC9t
bnQveCIpOwogICAgICAgIHN5cygiZ2V0ZmFjbCAvbW50L3giKTsKICAgICAgfQogICAgICBpZigw
KXsKICAgICAgICBpbnQgZmQgPSBvcGVuKCIvbW50L25ldyIsIE9fUkRXUnxPX0NSRUFULCAwNjY2
KTsKICAgICAgICBpZihmZCA8IDApIHBlcnJvcigib3BlbiAvbW50L25ldyIpOwogICAgICAgIGNo
YXIgYnVmWzMyXTsKICAgICAgICBtZW1zZXQoYnVmLCAxLCBzaXplb2YoYnVmKSk7CiAgICAgICAg
aWYod3JpdGUoZmQsIGJ1Ziwgc2l6ZW9mKGJ1ZikpIDwgMCkgcGVycm9yKCJ3cml0ZSIpOwogICAg
ICAgIGxzZWVrKGZkLCAob2ZmX3QpMCwgMCk7CiAgICAgICAgaW50IGZkMiA9IGNyZWF0KCIvbW50
L25ld25ldyIsIDA2NjYpOwogICAgICAgIGlmKGZkMiA8IDApIHBlcnJvcigiY3JlYXQgL21udC9u
ZXduZXciKTsKICAgICAgICBvZmZfdCBvMSA9IDA7CiAgICAgICAgb2ZmX3QgbzIgPSAwOwogICAg
ICAgIGlmKGNvcHlfZmlsZV9yYW5nZShmZCwgJm8xLCBmZDIsICZvMiwgMTYsIDApIDwgMCkgcGVy
cm9yKCJjb3B5X2ZpbGVfcmFuZ2UiKTsKICAgICAgfQogICAgICBpZigwKXsKICAgICAgICBzeXMo
ImVjaG8gLW4gbHM6IDsgbHMgLWwgL21udCIpOwogICAgICAgIHN5cygiZWNobyAtbiBsczogOyBs
cyAtbCAvbW50Ly4gL21udC96Iik7CiAgICAgICAgc3lzKCJlY2hvIC1uIGVjaG86IDsgZWNobyBo
aSA+IC9tbnQveCIpOwogICAgICAgIHN5cygiZWNobyAtbiBkZDogOyBkZCBpZj0vbW50L3kgb2Y9
L2Rldi9udWxsIGJzPTUxMiBjb3VudD0xIik7CiAgICAgICAgc3lzKCJlY2hvIC1uIHVtb3VudDog
OyB1bW91bnQgL21udCIpOwogICAgICB9CiAgICB9CiAgICBleGl0KDApOwogIH0KCiAgaW50IHBp
ZDIgPSBmb3JrKCk7CiAgaWYocGlkMiA9PSAwKXsKCiAgICB3aGlsZSgxKXsKICAgICAgc29ja2xl
bl90IHNpbmxlbiA9IHNpemVvZihzaW4pOwogICAgICBwcmludGYoImNhbGxpbmcgYWNjZXB0XG4i
KTsKICAgICAgaW50IHMxID0gYWNjZXB0KHMsIChzdHJ1Y3Qgc29ja2FkZHIgKikgJnNpbiwgJnNp
bmxlbik7CiAgICAgIHByaW50ZigiYWNjZXB0IHJldHVybmVkICVkXG4iLCBzMSk7CiAgICAgIGlm
KHMxIDwgMCkgeyBwZXJyb3IoImFjY2VwdCIpOyBleGl0KDEpOyB9CiAgICAgIAogICAgICB3aGls
ZSgxKXsKICAgICAgICBpZihyZWFkbihzMSwgJmlsZW4sIDQpIDwgMCkgYnJlYWs7CiAgICAgICAg
aWxlbiA9IG50b2hsKGlsZW4pOwogICAgICAgIGlsZW4gJj0gMHg3ZmZmZmZmZjsKICAgICAgICBp
ZihyZWFkbihzMSwgaWJ1ZiwgaWxlbikgPCAwKSBicmVhazsKICAgICAgICBvaSA9IGlpID0gMDsK
ICAgICAgICBwdXQzMigwKTsgLy8gcGxhY2UtaG9sZGVyIGZvciBsZW5ndGgKICAgICAgICBwYXJz
ZV9ycGMoKTsKI2lmIDEKICAgICAgICBpZihzeW1zdGFydCAhPSAtMSl7CiAgICAgICAgICBmb3Io
aW50IGkgPSAwOyBpIDwgMTY7IGkrKykKICAgICAgICAgICAgcHV0MzIoMHhmZmZmZmZmZik7CiAg
ICAgICAgfQojZW5kaWYKICAgICAgICAqKGludCopKG9idWYrMCkgPSBodG9ubCgob2kgLSA0KSB8
IDB4ODAwMDAwMDApOwogICAgICAgIGlmKGFhaSA+IE5BQSl7CiAgICAgICAgICBwcmludGYoIm9v
cHMgYWFpICVkIE5BQSAlZFxuIiwgYWFpLCBOQUEpOwogICAgICAgICAgZXhpdCgxKTsKICAgICAg
ICB9CiAgICAgICAgaWYoc3ltc3RhcnQgIT0gLTEpewogICAgICAgICAgZm9yKGludCBpID0gc3lt
c3RhcnQ7IGkgPCBvaSAmJiBhYWkgPCBOQUE7IGkgKz0gOCkKICAgICAgICAgICAgKih1bnNpZ25l
ZCBsb25nIGxvbmcgKikob2J1ZiArIGkpIF49IGFhW2FhaSsrXTsKICAgICAgICAgIHN5bXN0YXJ0
ID0gLTE7CiAgICAgICAgfQogICAgICAgIGlmKG9pID4gMCl7CiAgICAgICAgICBpZih3cml0ZShz
MSwgb2J1Ziwgb2kpPD0wKSBwZXJyb3IoIndyaXRlIik7CiAgICAgICAgfQoKICAgICAgICBpZihz
ZW5kX2JhY2spewogICAgICAgICAgc2VuZF9iYWNrID0gMDsKICAgICAgICAgIG9pID0gMDsKICAg
ICAgICAgIHB1dDMyKDApOyAvLyBkdW1teSBsZW5ndGgKICAgICAgICAgIHB1dF9ycGNfaGVhZGVy
KDB4NDAwMDAwMDAsIDEpOwoKICAgICAgICAgIC8vIENCX0NPTVBPVU5ECiAgICAgICAgICBwdXRf
b3BhcXVlKDAsICIiKTsgLy8gY29tcG91bmQgdGFnCiAgICAgICAgICBwdXQzMigyKTsgLy8gbWlu
b3IgdmVyc2lvbgogICAgICAgICAgcHV0MzIoMCk7IC8vIGNhbGxiYWNrX2lkZW50CiAgICAgICAg
ICBwdXQzMigyKTsgLy8gb3BlcmF0aW9ucyBpbiB0aGUgY29tcG91bmQKCiAgICAgICAgICAvLyBD
Ql9TRVFVRU5DRQogICAgICAgICAgcHV0MzIoMTEpOwogICAgICAgICAgZm9yKGludCBpID0gMDsg
aSA8IDQ7IGkrKykKICAgICAgICAgICAgcHV0MzIoMSk7IC8vIHNlc3Npb25pZAogICAgICAgICAg
cHV0MzIoMSk7IC8vIHNlcXVlbmNlaWQgPz8/CiAgICAgICAgICBwdXQzMigwKTsgLy8gc2xvdGlk
CiAgICAgICAgICBwdXQzMigwKTsgLy8gaGlnaGVzdF9zbG90aWQKICAgICAgICAgIHB1dDMyKDAp
OyAvLyBjYWNoZXRoaXMKICAgICAgICAgIHB1dDMyKDApOyAvLyBjc2FfcmVmZXJyaW5nX2NhbGxf
bGlzdHM8PgogICAgICAgICAgCiAgICAgICAgICBpbnQgeG9pID0gb2k7CiAgICAgICAgICBmb3Io
aW50IGkgPSAwOyBpIDwgMzI7IGkrKykKICAgICAgICAgICAgcHV0MzIoMHhmZmZmZmZmZik7CiAg
ICAgICAgICBmb3IoaW50IGkgPSB4b2k7IGkgPCBvaSAmJiBhYWkgPCBOQUE7IGkgKz0gOCkKICAg
ICAgICAgICAgKih1bnNpZ25lZCBsb25nIGxvbmcgKikob2J1ZiArIGkpIF49IGFhW2FhaSsrXTsK
ICAgICAgICAgICooaW50Kikob2J1ZiswKSA9IGh0b25sKChvaSAtIDQpIHwgMHg4MDAwMDAwMCk7
CiAgICAgICAgICBpZih3cml0ZShzMSwgb2J1Ziwgb2kpPD0wKSBwZXJyb3IoIndyaXRlIik7CiAg
ICAgICAgfQogICAgICB9CiAgICAgIGNsb3NlKHMxKTsKICAgIH0KICAgIGV4aXQoMSk7CiAgfQog
IGNsb3NlKHMpOwogIHNsZWVwKDIwKTsKICBpZihzeXN0ZW0oImRtZXNnIHwgZ3JlcCAndW5oYW5k
bGVkIHNpZyciKSA9PSAwKXsKICAgcHJpbnRmKCJ1bmhhbmRsZWQgc2lnbmFsXG4iKTsgd2hpbGUo
MSl7fQogIH0KfQo=
--=-=-=--
