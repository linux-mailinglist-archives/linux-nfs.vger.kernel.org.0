Return-Path: <linux-nfs-owner@vger.kernel.org>
X-Original-To: lists+linux-nfs@lfdr.de
Delivered-To: lists+linux-nfs@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 1170A484918
	for <lists+linux-nfs@lfdr.de>; Tue,  4 Jan 2022 21:08:21 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S232034AbiADUIU (ORCPT <rfc822;lists+linux-nfs@lfdr.de>);
        Tue, 4 Jan 2022 15:08:20 -0500
Received: from outgoing-stata.csail.mit.edu ([128.30.2.210]:36136 "EHLO
        outgoing-stata.csail.mit.edu" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S232214AbiADUIU (ORCPT
        <rfc822;linux-nfs@vger.kernel.org>); Tue, 4 Jan 2022 15:08:20 -0500
Received: from c-73-149-22-248.hsd1.ma.comcast.net ([73.149.22.248] helo=crash.local)
        by outgoing-stata.csail.mit.edu with esmtpsa (TLS1.2:DHE_RSA_AES_256_CBC_SHA256:256)
        (Exim 4.82)
        (envelope-from <rtm@csail.mit.edu>)
        id 1n4q6S-000PQL-No; Tue, 04 Jan 2022 15:08:16 -0500
Received: from crash.local (localhost [127.0.0.1])
        by crash.local (Postfix) with ESMTP id 1E5FE14524D2B;
        Tue,  4 Jan 2022 15:08:16 -0500 (EST)
to:     Trond Myklebust <trond.myklebust@hammerspace.com>,
        Anna Schumaker <anna.schumaker@netapp.com>
cc:     linux-nfs@vger.kernel.org
From:   rtm@csail.mit.edu
Reply-To: rtm@csail.mit.edu
Subject: nfs v4 decode_read_plus_hole() insufficient length sanity check
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="=-=-="
Date:   Tue, 04 Jan 2022 15:08:15 -0500
Message-ID: <5348.1641326895@crash.local>
Precedence: bulk
List-ID: <linux-nfs.vger.kernel.org>
X-Mailing-List: linux-nfs@vger.kernel.org

--=-=-=
Content-Type: text/plain

decode_read_plus_hole() reads a 64-bit length from the server's RPC
reply. There's a sanity-check:

        if (length + res->count > args->count) {

but it doesn't work if length is big enough that the sum wraps, e.g.
0xffffffffffffffff. In that case, eventually the loop in
xdr_buf_pages_zero() calls memset() on the wrong memory.

I've attached a demo:

# uname -a
Linux (none) 5.16.0-rc7-00108-g800829388818-dirty #23 SMP Tue Jan 4 19:38:52 UTC 2022 riscv64 riscv64 riscv64 GNU/Linux
# cc nfs_20.c
# ./a.out
...
[   74.362358] Unable to handle kernel paging request at virtual address 92492d8ddff40000
[   74.612471] status: 0000000200000121 badaddr: 92492d8ddff40000 cause: 000000000000000f
[   74.626913] [<ffffffff80346650>] __memset+0x60/0xfc
[   74.637735] [<ffffffff802333ac>] nfs4_xdr_dec_read_plus+0x2d6/0x3fa
[   74.650614] [<ffffffff80617406>] rpcauth_unwrap_resp_decode+0x12/0x1a
[   74.663084] [<ffffffff80618124>] rpcauth_unwrap_resp+0x12/0x1a
[   74.675822] [<ffffffff8060e23a>] call_decode+0x112/0x176
[   74.686253] [<ffffffff8061686c>] __rpc_execute+0x7e/0x21a
[   74.696694] [<ffffffff80616a2c>] rpc_async_schedule+0x24/0x46
[   74.709450] [<ffffffff800209d4>] process_one_work+0x13e/0x28a
[   74.722182] [<ffffffff80020b9c>] worker_thread+0x7c/0x320
[   74.732607] [<ffffffff80027010>] kthread+0x124/0x136
[   74.743073] [<ffffffff8000303e>] ret_from_exception+0x0/0xc
[   74.764059] ---[ end trace ca32aa753f3ddad2 ]---


--=-=-=
Content-Type: application/octet-stream
Content-Disposition: attachment; filename=nfs_20.c
Content-Transfer-Encoding: base64

I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPHN0ZGxpYi5o
PgojZGVmaW5lIF9HTlVfU09VUkNFCiNpbmNsdWRlIDx1bmlzdGQuaD4KI2luY2x1ZGUgPHN5cy9z
b2NrZXQuaD4KI2luY2x1ZGUgPHN5cy9maWxlLmg+CiNpbmNsdWRlIDxzeXMvaW9jdGwuaD4KI2lu
Y2x1ZGUgPG5ldGluZXQvaW4uaD4KI2luY2x1ZGUgPHN5cy93YWl0Lmg+CiNpbmNsdWRlIDxzeXMv
cmVzb3VyY2UuaD4KI2luY2x1ZGUgPHN5cy9wYXJhbS5oPgojaW5jbHVkZSA8c3lzL21vdW50Lmg+
CiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+CiNpbmNsdWRlIDxz
eXMvdmZzLmg+CiNpbmNsdWRlIDxkaXJlbnQuaD4KI2luY2x1ZGUgPGFzc2VydC5oPgojaW5jbHVk
ZSA8ZmNudGwuaD4KI2luY2x1ZGUgPGVycm5vLmg+CgppbnQgc3ltX29wID0gNjg7CmludCBzeW1f
c2tpcCA9IDA7CmludCBzeW1fdHlwZSA9IDA7IC8vIGFsbCBmYXR0cjQgZmlsZSB0eXBlcwppbnQg
c3ltX2ZoID0gMDsgLy8gYWxsIGZpbGUgaGFuZGxlcwppbnQgc3ltX2JpdG1hcHMgPSAwOwppbnQg
c3ltX29wYXF1ZV9sZW4gPSAwOwoKaW50IG9wY291bnRzWzI1Nl07CmxvbmcgbG9uZyBuZXh0X2Nv
b2tpZSA9IDM7CmludCBjdXJyZW50X2ZoID0gMDsKaW50IGNvbXBvdW5kX3N0YXR1czsKaW50IHNl
bmRfYmFjazsKCi8vIG1hcCBmaWxlL2RpciBuYW1lcyB0byBmaWxlIGhhbmRsZQpjaGFyICpmaG5h
bWVzWzEwMF0gPSB7CiAgICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgICAidG1wIiwKICAg
ICAgICAgICAgICAgIngiLAogICAgICAgICAgICAgICAieSIsCiAgICAgICAgICAgICAgICJ6IiwK
ICAgICAgICAgICAgICAgInp6eiIsCiAgICAgICAgICAgICAgIDAKfTsKCmludApuYW1lMmZoKGNo
YXIgKm5hbWUsIGludCBjcmVhdGUpCnsKICBmb3IoaW50IGkgPSAwOyBmaG5hbWVzW2ldOyBpKysp
ewogICAgaWYoc3RyY21wKG5hbWUsIGZobmFtZXNbaV0pID09IDApCiAgICAgIHJldHVybiBpOwog
IH0KICBpZihjcmVhdGUpewogICAgZm9yKGludCBpID0gMDsgOyBpKyspewogICAgICBpZihmaG5h
bWVzW2ldID09IDApewogICAgICAgIGZobmFtZXNbaV0gPSBtYWxsb2MoMTAwKTsKICAgICAgICBz
dHJjcHkoZmhuYW1lc1tpXSwgbmFtZSk7CiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0KICAgIH0K
ICB9CiAgcmV0dXJuIC0xOwp9CgojZGVmaW5lIE5BQSAxMjgKdW5zaWduZWQgbG9uZyBsb25nIGFh
W05BQV0gPSB7CjB4ZmZmZmZmZmZ1bGwsCjB4ZmVmZmZmZmZmODhjOWFkYXVsbCwKMHhmZmZmZmZm
ZmZmZmZmZmZmdWxsLAoweGZjZmZmZmZmZmZmZmZmZmZ1bGwsCjB4ZmZmZmZmZmZmZWZmZmZmZnVs
bCwKMHhmY2ZmZmZmZnVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGws
CjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwK
MHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAow
eDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4
MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgw
dWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1
bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVs
bCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxs
LAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGws
CjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwK
MHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAow
eDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4
MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgw
dWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1
bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVs
bCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxs
LAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCjB4MHVsbCwKMHgwdWxsLAoweDB1bGws
CjB4MHVsbCwKMHgwdWxsLAoweDB1bGwsCn07CmludCBhYWkgPSAwOwoKY2hhciBpYnVmWzE2KjEw
MjRdOwppbnQgaWxlbiA9IDA7CmludCBpaSA9IDA7CmNoYXIgb2J1ZlsxNioxMDI0XTsKaW50IG9p
ID0gMDsKaW50IHN5bXN0YXJ0ID0gLTE7CgppbnQgcmVhZG4oaW50IGZkLCB2b2lkICp4YnVmLCBp
bnQgbikgewogIGNoYXIgKmJ1ZiA9IChjaGFyICopIHhidWY7CiAgaW50IG9yaWcgPSBuOwogIHdo
aWxlKG4gPiAwKXsKICAgIGludCBjYyA9IHJlYWQoZmQsIGJ1Ziwgbik7CiAgICBpZihjYyA8PSAw
KSB7IHBlcnJvcigicmVhZCIpOyByZXR1cm4gLTE7IH0KICAgIG4gLT0gY2M7CiAgICBidWYgKz0g
Y2M7CiAgfQogIHJldHVybiBvcmlnOwp9Cgp1bnNpZ25lZCBpbnQKcGFyc2UzMigpCnsKICBpZihp
aSA+PSBpbGVuKXsKICAgIHByaW50ZigicGFyc2VkIGJleW9uZCB0aGUgZW5kIG9mIHRoZSBpbnB1
dFxuIik7CiAgICByZXR1cm4gMHhmZmZmZmZmZjsKICB9CiAgdW5zaWduZWQgaW50IHggPSAqKGlu
dCopKGlidWYraWkpOwogIGlpICs9IDQ7CiAgcmV0dXJuIG50b2hsKHgpOwp9Cgp1bnNpZ25lZCBs
b25nIGxvbmcKcGFyc2U2NCgpCnsKICB1bnNpZ25lZCBsb25nIGxvbmcgaGkgPSBwYXJzZTMyKCk7
CiAgdW5zaWduZWQgbG9uZyBsb25nIGxvID0gcGFyc2UzMigpOwogIHJldHVybiAoaGkgPDwgMzIp
IHwgbG87Cn0KCi8vIHNlc3Npb25pZDQgLS0gMTYgYnl0ZXMKdm9pZApwYXJzZV9zaWQoY2hhciAq
c2lkKQp7CiAgZm9yKGludCBpID0gMDsgaSA8IDE2OyBpKyspewogICAgaWYoc2lkKQogICAgICBz
aWRbaV0gPSBpYnVmW2lpXTsKICAgIGlpKys7CiAgfQp9Cgp1bnNpZ25lZCBpbnQKcGFyc2Vfb3Bh
cXVlKGNoYXIgKmJ1ZikKewogIGlmKGJ1ZikKICAgIGJ1ZlswXSA9IDA7CiAgaW50IG5vbWluYWxf
biA9IHBhcnNlMzIoKTsKICBpZihub21pbmFsX24gPiA0MDk2KXsKICAgIHByaW50ZigiY3Jhenkg
b3BhcXVlIGxlbmd0aCAlZFxuIiwgbm9taW5hbF9uKTsKICAgIHJldHVybiAwOwogIH0KICBpbnQg
cmVhbF9uID0gbm9taW5hbF9uOwogIHdoaWxlKChyZWFsX24lNCkgIT0gMCkgcmVhbF9uICs9IDE7
CiAgZm9yKGludCBpID0gMDsgaSA8IHJlYWxfbjsgaSsrKXsKICAgIGlmKGJ1ZiAmJiBpIDwgcmVh
bF9uKQogICAgICBidWZbaV0gPSBpYnVmW2lpXTsKICAgIGlpKys7CiAgfQogIHJldHVybiBub21p
bmFsX247Cn0KCnZvaWQKcHV0MzIodW5zaWduZWQgaW50IHgpCnsKICBhc3NlcnQoKG9pICUgNCkg
PT0gMCk7CiAgKihpbnQqKShvYnVmK29pKSA9IGh0b25sKHgpOwogIG9pICs9IDQ7Cn0KCnZvaWQK
cHV0NjQodW5zaWduZWQgbG9uZyBsb25nIHgpCnsKICBwdXQzMih4ID4+IDMyKTsKICBwdXQzMih4
KTsKfQoKdm9pZApwdXRfb3BhcXVlKGludCBuLCBjaGFyICpidWYpCnsKICBpbnQgbm4gPSBuOwog
IGlmKHN5bV9vcGFxdWVfbGVuICYmIGFhaSA8IE5BQSkKICAgIG5uIF49IGFhW2FhaSsrXTsKICBw
dXQzMihubik7CiAgZm9yKGludCBpID0gMDsgaSA8IG47IGkrKykKICAgIG9idWZbb2krK10gPSAo
YnVmID8gYnVmW2ldIDogMCk7CiAgd2hpbGUobiAmIDMpewogICAgb2J1ZltvaSsrXSA9IDA7CiAg
ICBuKys7CiAgfQp9Cgp2b2lkCnB1dF9zaWQoY2hhciAqc2lkKQp7CiAgZm9yKGludCBpID0gMDsg
aSA8IDE2OyBpKyspewogICAgb2J1ZltvaSsrXSA9IChzaWQgPyBzaWRbaV0gOiAwKTsKICB9Cn0K
CnZvaWQKcGFyc2Vfbm9wKCkKewp9Cgp2b2lkCnBhcnNlX29wX2V4Y2hhbmdlX2lkKCkKewogIHBh
cnNlMzIoKTsgLy8gdmVyaWZpZXI0LCBmaXJzdCBoYWxmCiAgcGFyc2UzMigpOyAvLyB2ZXJpZmll
cjQsIHNlY29uZCBoYWxmCiAgcGFyc2Vfb3BhcXVlKDApOyAvLyBlaWFfY2xpZW50b3duZXIKICBp
bnQgY2ZsYWdzID0gcGFyc2UzMigpOyAvLyBlaWFfZmxhZ3MKICBwYXJzZTMyKCk7IC8vIHN0YXRl
X3Byb3RlY3Q0X2Euc3BhX2hvdywgYXNzdW1lIFNQNF9OT05FCiAgaW50IG5pbXBsID0gcGFyc2Uz
MigpOyAvLyBsZW5ndGggb2YgY2xpZW50X2ltcGxfaWQKICBmb3IoaW50IGltcGxpID0gMDsgaW1w
bGkgPCBuaW1wbDsgaW1wbGkrKyl7CiAgICBjaGFyIGp1bmtbNTEyXTsKICAgIHBhcnNlX29wYXF1
ZShqdW5rKTsgLy8gbmlpX2RvbWFpbgogICAgLy8gcHJpbnRmKCJuaWlfZG9tYWluOiAlc1xuIiwg
anVuayk7CiAgICBwYXJzZV9vcGFxdWUoanVuayk7IC8vIG5paV9uYW1lCiAgICAvLyBwcmludGYo
Im5paV9uYW1lOiAlc1xuIiwganVuayk7CiAgICBwYXJzZTY0KCk7IC8vIDEvMiBvZiBuZnN0aW1l
NAogICAgcGFyc2UzMigpOyAvLyAxLzIgb2YgbmZzdGltZTQKICB9CgogIC8vIGZpbmlzaCBFWENI
QU5HRV9JRDRyZXMKICBwdXQzMigwKTsgLy8gZWlyX3N0YXR1cyA9IE5GUzRfT0sKICBwdXQ2NCgx
KTsgLy8gY2xpZW50aWQ0CiAgcHV0MzIoMSk7IC8vIHNlcXVlbmNlaWQ0CiAgaW50IHNmbGFncyA9
IDB4MTAzIHwgMHgxMDAwMDsgLy8gRVhDSEdJRDRfRkxBR19VU0VfTk9OX1BORlMKICBwdXQzMihz
ZmxhZ3MpOyAvLyBlaXJfZmxhZ3MKICBwdXQzMigwKTsgLy8gc3RhdGVfcHJvdGVjdDRfci5zcHJf
aG93ID0gU1A0X05PTkUKICBwdXQ2NCgxKTsgLy8gc2VydmVyX293bmVyNC5zb19taW5vcl9pZAog
IHB1dDMyKDQpOyAvLyBsZW5ndGggb2Ygc29fbWFqb3JfaWQ8PgogIHB1dDMyKDB4MTEyMjMzNDQp
OyAvLyBzb19tYWpvcl9pZDw+CiAgcHV0MzIoNCk7IC8vIGxlbmd0aCBvZiBlaXJfc2VydmVyX3Nj
b3BlCiAgcHV0MzIoMHgxMTIyMzM0NCk7CiAgcHV0MzIoMSk7IC8vIGxlbmd0aCBvZiBlaXJfc2Vy
dmVyX2ltcGxfaWQ8MT4KICBwdXQzMig0KTsgLy8gbmZzX2ltcGxfaWQ0Lm5paV9kb21haW4KICBw
dXQzMigweDExMjIzMzQ0KTsKICBwdXQzMig0KTsgLy8gbmZzX2ltcGxfaWQ0Lm5paV9uYW1lCiAg
cHV0MzIoMHgxMTIyMzM0NCk7CiAgcHV0NjQoMCk7IC8vIG5paV9kYXRlIDEvMgogIHB1dDMyKDAp
OyAvLyBuaWlfZGF0ZSAyLzIKfQoKdm9pZApwYXJzZV9vcF9jcmVhdGVfc2Vzc2lvbigpCnsKICBw
YXJzZTY0KCk7IC8vIGNzYV9jbGllbnRpZAogIGludCBzZXEgPSBwYXJzZTMyKCk7IC8vIGNzYV9z
ZXF1ZW5jZQogIHBhcnNlMzIoKTsgLy8gY3NhX2ZsYWdzCiAgLy8gY3NhX2ZvcmVfY2hhbl9hdHRy
cywgY3NhX2JhY2tfY2hhbl9hdHRycwogIGludCBhdHRyc1syXVs2XTsKICBmb3IoaW50IGkgPSAw
OyBpIDwgMjsgaSsrKXsKICAgIGZvcihpbnQgaiA9IDA7IGogPCA2OyBqKyspewogICAgICBhdHRy
c1tpXVtqXSA9IHBhcnNlMzIoKTsKICAgIH0KICAgIHBhcnNlX29wYXF1ZSgwKTsgLy8gY2FfcmRt
YV9pcmQ8MT4KICB9CiAgLy8gWFhYCiAgaWkgPSBpbGVuOwoKICBwdXQzMigwKTsgLy8gT0sKICBm
b3IoaW50IGkgPSAwOyBpIDwgNDsgaSsrKQogICAgcHV0MzIoMSk7IC8vIGNzcl9zZXNzaW9uaWQg
aS80CiAgcHV0MzIoc2VxKTsgLy8gY3NyX3NlcXVlbmNlCiAgcHV0MzIoMHgzKTsgLy8gY3NyX2Zs
YWdzCgogIGZvcihpbnQgaSA9IDA7IGkgPCAyOyBpKyspewogICAgZm9yKGludCBqID0gMDsgaiA8
IDY7IGorKykKICAgICAgcHV0MzIoYXR0cnNbaV1bal0pOwogICAgcHV0MzIoMCk7IC8vIGNhX3Jk
bWFfaXJkCiAgfQp9Cgp2b2lkCnBhcnNlX29wX3NlcXVlbmNlKCkKewogIGNoYXIgc2lkWzE2XTsK
CiAgcGFyc2Vfc2lkKHNpZCk7IC8vIHNhX3Nlc3Npb25pZAogIGludCBzZXEgPSBwYXJzZTMyKCk7
IC8vIHNhX3NlcXVlbmNlaWQKICBpbnQgc2xvdCA9IHBhcnNlMzIoKTsgLy8gc2Ffc2xvdGlkCiAg
aW50IGhpc2xvdCA9IHBhcnNlMzIoKTsgLy8gc2FfaGlnaGVzdF9zbG90aWQKICBwYXJzZTMyKCk7
IC8vIHNhX2NhY2hldGhpcwoKICBwdXQzMigwKTsgLy8gT0sKICBwdXRfc2lkKHNpZCk7IC8vIHNy
X3Nlc3Npb25pZAogIHB1dDMyKHNlcSk7IC8vIHNyX3NlcXVlbmNlaWQKICBwdXQzMihzbG90KTsg
Ly8gc3Jfc2xvdGlkCiAgcHV0MzIoaGlzbG90KTsgLy8gc3JfaGlnaGVzdF9zbG90aWQKICBwdXQz
MihoaXNsb3QpOyAvLyBzcl90YXJnZXRfaGlnaGVzdF9zbG90aWQKICBwdXQzMigwKTsgLy8gc3Jf
c3RhdHVzX2ZsYWdzCn0KCnZvaWQKcGFyc2Vfb3BfcmVjbGFpbV9jb21wbGV0ZSgpCnsKICBwYXJz
ZTMyKCk7IC8vIHJjYV9vbmVfZnMKICBwdXQzMigwKTsgLy8gcmNyX3N0YXR1cwp9Cgp2b2lkCnBh
cnNlX29wX3B1dHJvb3RmaCgpCnsKICAvLyBubyBhcmd1bWVudHMKICBwdXQzMigwKTsgLy8gT0sK
ICBjdXJyZW50X2ZoID0gMDsKfQoKdm9pZApwYXJzZV9vcF9zZWNpbmZvX25vX25hbWUoKQp7CiAg
cGFyc2UzMigpOyAvLyBzZWNpbmZvX3N0eWxlNAogIHB1dDMyKDApOyAvLyBPSwogIHB1dDMyKDEp
OyAvLyAjIG9mIHNlY2luZm80CiNpZiAxCiAgcHV0MzIoMCk7IC8vIGZsYXZvciA9IEFVVEhfTlVM
TAojZWxzZQogIHB1dDMyKDYpOyAvLyBmbGF2b3IgPSBSUENTRUNfR1NTCiAgcHV0MzIoNCk7IC8v
IHNpemUgb2Ygc2VjX29pZDQKICBwdXQzMigweGZmZmZmZmZmKTsKICBwdXQzMigwKTsgLy8gcW9w
NAogIHB1dDMyKDEpOyAvLyBycGNfZ3NzX3N2Y190CiNlbmRpZgp9Cgp2b2lkCnBhcnNlX29wX2Rl
c3Ryb3lfc2Vzc2lvbigpCnsKICBwYXJzZV9zaWQoMCk7CiAgcHV0MzIoMCk7IC8vIE9LCn0KCnZv
aWQKcGFyc2Vfb3BfZGVzdHJveV9jbGllbnRpZCgpCnsKICBwYXJzZTY0KCk7IC8vIGNsaWVudGlk
CiAgcHV0MzIoMCk7IC8vIE9LCn0KCnZvaWQKcGFyc2Vfb3BfZ2V0ZmgoKQp7CiAgLy8gbm8gYXJn
dW1lbnRzCiAgcHV0MzIoMCk7IC8vIE9LCiAgaW50IHhmaCA9IGN1cnJlbnRfZmg7CiAgaWYoc3lt
X2ZoKSB4ZmggXj0gYWFbYWFpKytdOwogIHB1dF9vcGFxdWUoNCwgKGNoYXIqKSZ4ZmgpOyAvLyBm
aAp9CgovLwovLyBjYWxsZWQgYnkgZ2V0YXR0ciBhbmQgcmVhZGRpci4KLy8gZ2VuZXJhdGVzIGEg
ZmF0dHI0IChiaXRtYXA0IHRoZW4gYXR0cmxpc3Q0KS4KLy8Kdm9pZApwdXRfZmF0dHI0KGludCB4
d29yZHNbXSwgaW50IGZoKQp7CiAgaW50IHdvcmRzWzNdOwogIGZvcihpbnQgaSA9IDA7IGkgPCAz
OyBpKyspewogICAgd29yZHNbaV0gPSB4d29yZHNbaV07CiAgICBpZihzeW1fYml0bWFwcyl7CiAg
ICAgIHdvcmRzW2ldIF49IGFhW2FhaSsrXTsKICAgIH0KICB9CiAgaW50IGJpdHdvcmRzID0gMzsK
ICBwdXQzMihiaXR3b3Jkcyk7CiAgaW50IHdvcmQwaSA9IG9pOwogIGZvcihpbnQgaSA9IDA7IGkg
PCBiaXR3b3JkczsgaSsrKQogICAgcHV0MzIod29yZHNbaV0pOwogIGludCBsZW5pID0gb2k7CiAg
cHV0MzIoMCk7IC8vIHBsYWNlaG9sZGVyIGZvciB0b3RhbCBsZW5ndGggb2YgYXR0cnMKICBmb3Io
aW50IGEgPSAwOyBhIDwgYml0d29yZHMqMzI7IGErKyl7CiAgICBpZih3b3Jkc1thLzMyXSAmICgx
IDw8IChhICUgMzIpKSl7CiAgICAgIGlmKGEgPT0gMCl7CiAgICAgICAgcHV0MzIoMyk7IC8vICMg
Yml0bWFwIHdvcmRzIG9mIHN1cHBvcnRlZCBhdHRycwogICAgICAgIHB1dDMyKDB4ZmZmZmZmZmYp
OwogICAgICAgIHB1dDMyKDB4ZmZmZmZmZmYpOwogICAgICAgIHB1dDMyKDB4ZmZmZmZmZmYpOwog
ICAgICB9IGVsc2UgaWYoYSA9PSAxKXsKICAgICAgICBpbnQgdHlwZSA9IDE7CiAgICAgICAgaWYo
ZmggPT0gMCB8fCBmaCA9PSAxKQogICAgICAgICAgdHlwZSA9IDI7CiAgICAgICAgaWYoc3ltX3R5
cGUpIHR5cGUgXj0gYWFbYWFpKytdOwogICAgICAgIHB1dDMyKHR5cGUpOyAvLyBORjRESVI9MiBv
ciBORjRSRUc9MQogICAgICB9IGVsc2UgaWYoYSA9PSAyKXsKICAgICAgICBwdXQzMigwKTsgLy8g
ZmhfZXhwaXJlX3R5cGUKICAgICAgfSBlbHNlIGlmKGEgPT0gMyl7CiAgICAgICAgcHV0NjQoMCk7
IC8vIGNoYW5nZQogICAgICB9IGVsc2UgaWYoYSA9PSA0KXsKICAgICAgICBwdXQ2NCg0MDk2KjEw
KTsgLy8gc2l6ZQogICAgICB9IGVsc2UgaWYoYSA9PSA1KXsKICAgICAgICBwdXQzMigxKTsgLy8g
bGluayBzdXBwb3J0CiAgICAgIH0gZWxzZSBpZihhID09IDYpewogICAgICAgIHB1dDMyKDEpOyAv
LyBzeW1saW5rIHN1cHBvcnQKICAgICAgfSBlbHNlIGlmKGEgPT0gOCl7CiAgICAgICAgcHV0NjQo
MSk7IC8vIGZzaWQgbWFqb3IKICAgICAgICBwdXQ2NCgxKTsgLy8gZnNpZCBtaW5vcgogICAgICB9
IGVsc2UgaWYoYSA9PSAxMCl7CiAgICAgICAgcHV0MzIoMTApOyAvLyBsZWFzZSB0aW1lCiAgICAg
IH0gZWxzZSBpZihhID09IDExKXsKICAgICAgICBwdXQzMigwKTsgLy8gcmRhdHRyX2Vycm9yCiAg
ICAgIH0gZWxzZSBpZihhID09IDEyKXsKICAgICAgICAvLyBBQ0wKICAgICAgICBpbnQgbiA9IDI7
CiAgICAgICAgcHV0MzIobik7CiAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IG47IGkrKyl7CiAg
ICAgICAgICBwdXQzMigwKTsgLy8gdHlwZQogICAgICAgICAgcHV0MzIoMCk7IC8vIGZsYWcKICAg
ICAgICAgIHB1dDMyKDApOyAvLyBtYXNrCiAgICAgICAgICBjaGFyIHdob1s5XTsKICAgICAgICAg
IG1lbXNldCh3aG8sIDAsIHNpemVvZih3aG8pKTsKICAgICAgICAgIHN0cmNweSh3aG8sICJub2Jv
ZHkiKTsKICAgICAgICAgIHB1dF9vcGFxdWUoc3RybGVuKHdobyksIHdobyk7CiAgICAgICAgfQog
ICAgICB9IGVsc2UgaWYoYSA9PSAxMyl7CiAgICAgICAgcHV0MzIoMHhmKTsgLy8gYWNsc3VwcG9y
dAogICAgICB9IGVsc2UgaWYoYSA9PSAxNSl7CiAgICAgICAgcHV0MzIoMSk7IC8vIGNhbnNldHRp
bWUKICAgICAgfSBlbHNlIGlmKGEgPT0gMTYpewogICAgICAgIHB1dDMyKDApOyAvLyBjYXNlIGlu
c2Vuc2l0aXZlCiAgICAgIH0gZWxzZSBpZihhID09IDE3KXsKICAgICAgICBwdXQzMigxKTsgLy8g
Y2FzZSBwcmVzZXJ2aW5nCiAgICAgIH0gZWxzZSBpZihhID09IDE4KXsKICAgICAgICBwdXQzMigw
KTsgLy8gY2hvd25fcmVzdHJpY3RlZAogICAgICB9IGVsc2UgaWYoYSA9PSAxOSl7CiAgICAgICAg
Ly8gZmlsZWhhbmRsZQogICAgICAgIGludCB4ZmggPSBmaDsKICAgICAgICBpZihzeW1fZmgpIHhm
aCBePSBhYVthYWkrK107CiAgICAgICAgcHV0X29wYXF1ZSg0LCAoY2hhciopJnhmaCk7IC8vIGZo
CiAgICAgIH0gZWxzZSBpZihhID09IDIwKXsKICAgICAgICBwdXQ2NChmaCk7IC8vIGZpbGVpZAog
ICAgICB9IGVsc2UgaWYoYSA9PSAyMSl7CiAgICAgICAgcHV0NjQoOTk5OSk7IC8vIGZpbGVzX2F2
YWlsCiAgICAgIH0gZWxzZSBpZihhID09IDIyKXsKICAgICAgICBwdXQ2NCg5OTk5KTsgLy8gZmls
ZXNfZnJlZQogICAgICB9IGVsc2UgaWYoYSA9PSAyMyl7CiAgICAgICAgcHV0NjQoOTk5OTkpOyAv
LyBmaWxlc190b3RhbAogICAgICB9IGVsc2UgaWYoYSA9PSAyNCl7CiAgICAgICAgLy8gZnNfbG9j
YXRpb25zCiAgICAgICAgcHV0MzIoMSk7CiAgICAgICAgcHV0X29wYXF1ZSgxMCwgImFiY2RlMTIz
NDUiKTsgLy8gcGF0aG5hbWU0CiAgICAgICAgcHV0MzIoMSk7IC8vIGxvY2F0aW9uczw+CiAgICAg
ICAgcHV0X29wYXF1ZSgxMCwgImFiY2RlMTIzNDUiKTsgLy8gc2VydmVyCiAgICAgICAgcHV0MzIo
MSk7CiAgICAgICAgcHV0X29wYXF1ZSgxMCwgImFiY2RlMTIzNDUiKTsgLy8gcm9vdHBhdGgKICAg
ICAgfSBlbHNlIGlmKGEgPT0gMjYpewogICAgICAgIHB1dDMyKDEpOyAvLyBob21vZ2VuZW91cwog
ICAgICB9IGVsc2UgaWYoYSA9PSAyNyl7CiAgICAgICAgcHV0NjQoMHhmZmZmZmZmZmZmZmYpOyAv
LyBtYXggZmlsZSBzaXplCiAgICAgIH0gZWxzZSBpZihhID09IDI4KXsKICAgICAgICBwdXQzMigw
eGZmZmYpOyAvLyBtYXggbGluawogICAgICB9IGVsc2UgaWYoYSA9PSAyOSl7CiAgICAgICAgcHV0
MzIoMjU2KTsgLy8gbWF4IG5hbWUKICAgICAgfSBlbHNlIGlmKGEgPT0gMzApewogICAgICAgIHB1
dDY0KDEwKjQwOTYpOyAvLyBtYXggcmVhZAogICAgICB9IGVsc2UgaWYoYSA9PSAzMSl7CiAgICAg
ICAgcHV0NjQoMTAqNDA5Nik7IC8vIG1heCB3cml0ZQogICAgICB9IGVsc2UgaWYoYSA9PSAzMyl7
CiAgICAgICAgcHV0MzIoMDc3Nyk7IC8vIG1vZGUKICAgICAgfSBlbHNlIGlmKGEgPT0gMzQpewog
ICAgICAgIHB1dDMyKDEpOyAvLyBub190cnVuYwogICAgICB9IGVsc2UgaWYoYSA9PSAzNSl7CiAg
ICAgICAgcHV0MzIoMyk7IC8vIG51bWxpbmtzCiAgICAgIH0gZWxzZSBpZihhID09IDM2KXsKICAg
ICAgICAvLyBwdXRfb3BhcXVlKDYsICJvdGhlciIpOyAvLyBvd25lcgogICAgICAgIHB1dF9vcGFx
dWUoNiwgIm5vYm9keSIpOyAvLyBvd25lcgogICAgICAgIC8vIHB1dF9vcGFxdWUoNSwgIjY1NTM0
Iik7IC8vIG93bmVyCiAgICAgIH0gZWxzZSBpZihhID09IDM3KXsKICAgICAgICAvLyBwdXRfb3Bh
cXVlKDYsICJvdGhlciIpOyAvLyBvd25lcl9ncm91cAogICAgICAgIHB1dF9vcGFxdWUoNiwgIm5v
Ym9keSIpOyAvLyBvd25lcl9ncm91cAogICAgICAgIC8vIHB1dF9vcGFxdWUoNSwgIjY1NTM0Iik7
IC8vIG93bmVyX2dyb3VwCiAgICAgIH0gZWxzZSBpZihhID09IDQxKXsKICAgICAgICBwdXQzMigw
KTsgLy8gcmF3ZGV2IG1ham9yCiAgICAgICAgcHV0MzIoMCk7IC8vIHJhd2RldiBtaW5vcgogICAg
ICB9IGVsc2UgaWYoYSA9PSA0Mil7CiAgICAgICAgcHV0NjQoMTAqMTAyNCoxMDI0KTsgLy8gc3Bh
Y2VfYXZhaWwKICAgICAgfSBlbHNlIGlmKGEgPT0gNDMpewogICAgICAgIHB1dDY0KDEwKjEwMjQq
MTAyNCk7IC8vIHNwYWNlX2ZyZWUKICAgICAgfSBlbHNlIGlmKGEgPT0gNDQpewogICAgICAgIHB1
dDY0KDIwKjEwMjQqMTAyNCk7IC8vIHNwYWNlX3RvdGFsCiAgICAgIH0gZWxzZSBpZihhID09IDQ1
KXsKICAgICAgICBwdXQ2NCg0MDk2KjEwKTsgLy8gc3BhY2UgdXNlZAogICAgICB9IGVsc2UgaWYo
YSA9PSA0Nyl7CiAgICAgICAgcHV0NjQoMCk7IC8vIHRpbWUgYWNjZXNzIHNlY29uZHMKICAgICAg
ICBwdXQzMigwKTsgLy8gbnNlY29uZHMKICAgICAgfSBlbHNlIGlmKGEgPT0gNTApewogICAgICAg
IHB1dDY0KDApOyAvLyB0aW1lIGNyZWF0ZSBzZWNvbmRzCiAgICAgICAgcHV0MzIoMCk7IC8vIG5z
ZWNvbmRzCiAgICAgIH0gZWxzZSBpZihhID09IDUxKXsKICAgICAgICBwdXQ2NCgwKTsgLy8gdGlt
ZSBkZWx0YSBzZWNvbmRzCiAgICAgICAgcHV0MzIoMCk7IC8vIG5zZWNvbmRzCiAgICAgIH0gZWxz
ZSBpZihhID09IDUyKXsKICAgICAgICBwdXQ2NCgwKTsgLy8gdGltZSBtZXRhZGF0YSBzZWNvbmRz
CiAgICAgICAgcHV0MzIoMCk7IC8vIG5zZWNvbmRzCiAgICAgIH0gZWxzZSBpZihhID09IDUzKXsK
ICAgICAgICBwdXQ2NCgwKTsgLy8gdGltZSBtb2RpZnkgc2Vjb25kcwogICAgICAgIHB1dDMyKDAp
OyAvLyBuc2Vjb25kcwogICAgICB9IGVsc2UgaWYoYSA9PSA1NSl7CiAgICAgICAgcHV0NjQoMCk7
IC8vIG1vdW50ZWRfb25fZmlsZWlkID8/PwogICAgICB9IGVsc2UgaWYoYSA9PSA2Mil7CiAgICAg
ICAgLy8gZnNfbGF5b3V0X3R5cGVzCiAgICAgICAgcHV0MzIoMSk7CiAgICAgICAgcHV0MzIoMSk7
IC8vIExBWU9VVDRfTkZTVjRfMV9GSUxFUwogICAgICB9IGVsc2UgaWYoYSA9PSA2NSl7CiAgICAg
ICAgLy8gTEFZT1VUX0JMS1NJWkUKICAgICAgICBwdXQzMigxMDI0KTsKICAgICAgfSBlbHNlIGlm
KGEgPT0gNzcpewogICAgICAgIC8vIENMT05FX0JMS1NJWkUKICAgICAgICBwdXQzMigxMDI0KTsK
ICAgICAgfSBlbHNlIGlmKGEgPT0gNzkpewogICAgICAgIC8vIENIQU5HRV9BVFRSX1RZUEUKICAg
ICAgICBwdXQzMig0KTsgLy8gPz8/CiAgICAgIH0gZWxzZSBpZihhID09IDgyKXsKICAgICAgICAv
LyBDSEFOR0VfQVRUUl9UWVBFCiAgICAgICAgcHV0MzIoNCk7IC8vID8/PwogICAgICB9IGVsc2Ug
aWYoYSA9PSA3NSl7CiAgICAgICAgLy8gRkFUVFI0X1NVUFBBVFRSX0VYQ0xDUkVBVAogICAgICAg
IHB1dDMyKDIpOyAvLyBiaXRtYXAgbGVuZ3RoCiAgICAgICAgcHV0MzIoMHhmZmZmZmZmZik7CiAg
ICAgICAgcHV0MzIoMHhmZmZmZmZmZik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYoc3ltX2Jp
dG1hcHMpewogICAgICAgICAgd29yZHNbYS8zMl0gJj0gfigxIDw8IChhICUgMzIpKTsKICAgICAg
ICAgICooaW50Kikob2J1ZiArIHdvcmQwaSArIDQqKGEvMzIpKSA9IGh0b25sKHdvcmRzW2EvMzJd
KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHJpbnRmKCJ1bmtub3duIHJlcXVlc3RlZCBh
dHRyICVkXG4iLCBhKTsKICAgICAgICAgIHB1dDY0KDApOyAvLyBYWFgKICAgICAgICB9CiAgICAg
IH0KICAgIH0KICB9CiNpZiAwCiAgZm9yKGludCBpID0gMDsgaSA8IDE2OyBpKyspCiAgICBwdXQz
MigweGZmZmZmZmZmKTsKI2VuZGlmCiAgKihpbnQqKShvYnVmK2xlbmkpID0gaHRvbmwob2kgLSBs
ZW5pIC0gNCk7Cn0KCnZvaWQKcGFyc2Vfb3BfZ2V0YXR0cigpCnsKICBpbnQgYml0d29yZHMgPSBw
YXJzZTMyKCk7CiAgaW50IHdvcmRzWzRdOwogIG1lbXNldCh3b3JkcywgMCwgc2l6ZW9mKHdvcmRz
KSk7CiAgaWYoYml0d29yZHMgPCAxIHx8IGJpdHdvcmRzID4gMykKICAgIHByaW50ZigicGFyc2Vf
b3BfZ2V0YXR0cjogY3JhenkgYml0d29yZHMgJWRcbiIsIGJpdHdvcmRzKTsKICBmb3IoaW50IGkg
PSAwOyBpIDwgYml0d29yZHMgJiYgaSA8IDQ7IGkrKykKICAgIHdvcmRzW2ldID0gcGFyc2UzMigp
OwogIHB1dDMyKDApOyAvLyBPSwogIHB1dF9mYXR0cjQod29yZHMsIGN1cnJlbnRfZmgpOwp9Cgp2
b2lkCnBhcnNlX29wX3B1dGZoKCkKewogIGNoYXIgYnVmWzY0XTsKICBpbnQgbiA9IHBhcnNlX29w
YXF1ZShidWYpOyAvLyBmaAogIGlmKG4gIT0gNCl7CiAgICBwcmludGYoIm9wX3B1dGZoIGZoIHNp
emUgJWQsIG5vdCA0XG4iLCBuKTsKICAgIGV4aXQoMSk7CiAgfQogIGludCBmaCA9ICooaW50Kili
dWY7CiAgY3VycmVudF9maCA9IGZoOwogIHB1dDMyKDApOyAvLyBPSwp9Cgp2b2lkCnBhcnNlX29w
X2FjY2VzcygpCnsKICBpbnQgbWFzayA9IHBhcnNlMzIoKTsgLy8gbWFzayBvZiByaWdodHMgdG8g
cXVlcnkKICBwdXQzMigwKTsgLy8gT0sKICBwdXQzMihtYXNrKTsgLy8gc3VwcG9ydGVkID0gYWxs
IHJpZ2h0cwogIHB1dDMyKG1hc2spOyAvLyBhY2Nlc3MgPSBhbGwgcmlnaHRzCn0KCnZvaWQKcGFy
c2Vfb3BfbG9va3VwKCkKewogIGNoYXIgbmFtZVsyNTZdOwogIGludCBuID0gcGFyc2Vfb3BhcXVl
KG5hbWUpOwogIG5hbWVbbj49MD9uOjBdID0gJ1wwJzsKICBpbnQgeGZoID0gbmFtZTJmaChuYW1l
LCAwKTsKICBpZih4ZmggPCAwKXsKICAgIHByaW50ZigibG9va3VwICVzIC0+IEVOT0VOVFxuIiwg
bmFtZSk7CiAgICBwdXQzMigyKTsgLy8gTkZTNEVSUl9OT0VOVAogICAgaWYoY29tcG91bmRfc3Rh
dHVzID09IDApCiAgICAgIGNvbXBvdW5kX3N0YXR1cyA9IDI7CiAgfSBlbHNlIHsKICAgIHB1dDMy
KDApOyAvLyBPSwogICAgY3VycmVudF9maCA9IHhmaDsKICAgIHByaW50ZigibG9va3VwICVzIC0+
IGZoICVkXG4iLCBuYW1lLCBjdXJyZW50X2ZoKTsKICB9Cn0KCnZvaWQKcGFyc2Vfb3BfbG9va3Vw
cCgpCnsKICBjdXJyZW50X2ZoID0gMTsgLy8gL3RtcAogIHB1dDMyKDApOyAvLyBPSwp9Cgp2b2lk
CnBhcnNlX29wX3JlYWRkaXIoKQp7CiAgbG9uZyBsb25nIGNvb2tpZSA9IHBhcnNlNjQoKTsKICBs
b25nIGxvbmcgdmVyZiA9IHBhcnNlNjQoKTsgLy8gY29va2llIHZlcmlmaWVyCiAgcGFyc2UzMigp
OyAvLyBkaXJjb3VudAogIHBhcnNlMzIoKTsgLy8gbWF4Y291bnQKICAvLyBhdHRyX3JlcXVlc3QK
ICBpbnQgYml0d29yZHMgPSBwYXJzZTMyKCk7CiAgaW50IHdvcmRzWzRdOwogIG1lbXNldCh3b3Jk
cywgMCwgc2l6ZW9mKHdvcmRzKSk7CiAgZm9yKGludCBpID0gMDsgaSA8IGJpdHdvcmRzICYmIGkg
PCA0OyBpKyspCiAgICB3b3Jkc1tpXSA9IHBhcnNlMzIoKTsKCiAgcHV0MzIoMCk7IC8vIE9LCiAg
cHV0NjQodmVyZik7IC8vIGNvb2tpZXZlcmYKICBjaGFyICpuYW1lc1tdID0geyAieiIsICJ6enoi
IH07CiAgZm9yKGludCBpID0gMDsgaSA8IDI7IGkrKyl7CiAgICBwdXQzMigxKTsgLy8gKm5leHRl
bnRyeQogICAgcHV0NjQobmV4dF9jb29raWUrKyk7IC8vIGNvb2tpZQogICAgcHV0X29wYXF1ZSgz
LCBuYW1lc1tpXSk7IC8vIG5hbWUKICAgIHB1dF9mYXR0cjQod29yZHMsIG5hbWUyZmgobmFtZXNb
aV0sIDEpKTsKICB9CgogIHB1dDMyKDApOyAvLyAqbmV4dGVudHJ5CgogIHB1dDMyKDEpOyAvLyBl
b2YKfQoKdm9pZApwYXJzZV9vcF9vcGVuKCkKewogIGNoYXIgbmFtZVsyNTZdOwogIG5hbWVbMF0g
PSAwOwogIHBhcnNlMzIoKTsgLy8gc2VxaWQKICBwYXJzZTMyKCk7IC8vIHNoYXJlX2FjY2Vzcwog
IHBhcnNlMzIoKTsgLy8gc2hhcmVfZGVueQogIHBhcnNlNjQoKTsgLy8gb3duZXIgY2xpZW50IGlk
CiAgcGFyc2Vfb3BhcXVlKDApOyAvLyBvd25lciBvd25lcgogIC8vIG9wZW5mbGFnNAogIGludCBv
cGVudHlwZSA9IHBhcnNlMzIoKTsKICBpZihvcGVudHlwZSA9PSAxKXsKICAgIC8vIE9QRU40X0NS
RUFURQogICAgaW50IG1vZGUgPSBwYXJzZTMyKCk7IC8vIGNyZWF0ZWhvdzQKICAgIGlmKG1vZGUg
PT0gMCl7CiAgICAgIC8vIFVOQ0hFQ0tFRDQKICAgICAgLy8gZmF0dHI0IGNyZWF0ZWF0dHJzCiAg
ICAgIGludCBiaXR3b3JkcyA9IHBhcnNlMzIoKTsKICAgICAgaW50IHdvcmRzWzMyXTsKICAgICAg
Zm9yKGludCBpID0gMDsgaSA8IGJpdHdvcmRzOyBpKyspCiAgICAgICAgd29yZHNbaV0gPSBwYXJz
ZTMyKCk7CiAgICAgIHBhcnNlX29wYXF1ZSgwKTsgLy8gYXR0cmxpc3Q0CiAgICB9IGVsc2Ugewog
ICAgICBwcmludGYoIk9QRU40X0NSRUFURSB1bmtub3duIG1vZGUgJWRcbiIsIG1vZGUpOwogICAg
ICBleGl0KDEpOwogICAgfQogIH0gZWxzZSBpZihvcGVudHlwZSA9PSAwKXsKICAgIC8vIE9QRU40
X05PQ1JFQVRFCiAgfSBlbHNlIHsKICAgIHByaW50ZigidW5rbm93biBvcGVudHlwZSAlZFxuIiwg
b3BlbnR5cGUpOwogICAgZXhpdCgxKTsKICB9CiAgaW50IG9wZW5fY2xhaW1fdHlwZSA9IHBhcnNl
MzIoKTsKICBpZihvcGVuX2NsYWltX3R5cGUgPT0gMCl7CiAgICAvLyBDTEFJTV9OVUxMCiAgICBw
YXJzZV9vcGFxdWUobmFtZSk7IC8vIGZpbGUgbmFtZQogIH0gZWxzZSBpZihvcGVuX2NsYWltX3R5
cGUgPT0gMil7CiAgICAvLyBDTEFJTV9ERUxFR0FURV9DVVIKICAgIC8vIG9wZW5fY2xhaW1fZGVs
ZWdhdGVfY3VyNAogICAgLy8gc3RhdGVpZDQKICAgIHBhcnNlMzIoKTsgLy8gc2VxaWQKICAgIHBh
cnNlMzIoKTsKICAgIHBhcnNlMzIoKTsKICAgIHBhcnNlMzIoKTsKICAgIHBhcnNlX29wYXF1ZShu
YW1lKTsgLy8gZmlsZSBuYW1lCiAgfSBlbHNlIGlmKG9wZW5fY2xhaW1fdHlwZSA9PSA0KXsKICAg
IC8vIENMQUlNX0ZICiAgfSBlbHNlIHsKICAgIHByaW50Zigib3ksIG9wZW5fY2xhaW1fdHlwZSAl
ZFxuIiwgb3Blbl9jbGFpbV90eXBlKTsKICAgIGV4aXQoMSk7CiAgfQoKICBpbnQgeGZoID0gbmFt
ZTJmaChuYW1lLCBvcGVudHlwZSk7CiAgaWYoeGZoIDwgMCl7CiAgICBwcmludGYoIm9wZW4oJXMp
IEVOT0VOVFxuIiwgbmFtZSk7CiAgICBwdXQzMigyKTsgLy8gTkZTNEVSUl9OT0VOVAogIH0gZWxz
ZSB7CiAgICBwdXQzMigwKTsgLy8gT0sKICAgIC8vIHN0YXRlaWQ0CiAgICBwdXQzMigxKTsgLy8g
c2VxaWQKICAgIHB1dDMyKDEpOyAvLyBvdGhlcgogICAgcHV0MzIoMSk7CiAgICBwdXQzMigxKTsK
ICAgIC8vIGNoYW5nZV9pbmZvNAogICAgcHV0MzIoMSk7CiAgICBwdXQ2NCgwKTsgLy8gYmVmb3Jl
CiAgICBwdXQ2NCgwKTsgLy8gYWZ0ZXIKICAgIHB1dDMyKDApOyAvLyByZmxhZ3MKICAgIHB1dDMy
KDApOyAvLyBhdHRyc2V0IGJpdG1hcCBsZW5ndGgKICAgIC8vIG9wZW5fZGVsZWdhdGlvbjQKICAg
IHB1dDMyKDApOyAvLyBPUEVOX0RFTEVHQVRFX05PTkUKICAgIHByaW50ZigiICBuYW1lPSVzXG4i
LCBuYW1lKTsKICAgIGlmKG5hbWVbMF0pewogICAgICBjdXJyZW50X2ZoID0geGZoOwogICAgfSBl
bHNlIHsKICAgICAgcHJpbnRmKCJvcF9vcGVuOiBubyBuYW1lIHdpdGggd2hpY2ggdG8gc2V0IGZo
XG4iKTsKICAgIH0KICB9Cn0KCnZvaWQKcGFyc2Vfb3Bfc2V0YXR0cigpCnsKICAvLyBzdGF0ZWlk
NAogIHBhcnNlMzIoKTsgLy8gc2VxaWQKICBwYXJzZTMyKCk7IC8vIG90aGVyCiAgcGFyc2UzMigp
OyAvLyBvdGhlcgogIHBhcnNlMzIoKTsgLy8gb3RoZXIKICAvLyBmYXR0cjQKICBpbnQgYml0d29y
ZHMgPSBwYXJzZTMyKCk7CiAgaW50IHdvcmRzWzY0XTsKICBmb3IoaW50IGkgPSAwOyBpIDwgYml0
d29yZHM7IGkrKykKICAgIHdvcmRzW2ldID0gcGFyc2UzMigpOwogIHBhcnNlX29wYXF1ZSgwKTsg
Ly8gYXR0cmxpc3Q0CgogIHB1dDMyKDApOyAvLyBPSwogIHB1dDMyKGJpdHdvcmRzKTsKICBmb3Io
aW50IGkgPSAwOyBpIDwgYml0d29yZHM7IGkrKykKICAgIHB1dDMyKHdvcmRzW2ldKTsKfQoKdm9p
ZApwYXJzZV9vcF9sYXlvdXRnZXQoKQp7CiAgcGFyc2UzMigpOyAvLyBsb2dhX3NpZ25hbF9sYXlv
dXRfYXZhaWwKICBwYXJzZTMyKCk7IC8vIGxheW91dHR5cGU0CiAgcGFyc2UzMigpOyAvLyBsYXlv
dXRpb21vZGU0CiAgcGFyc2U2NCgpOyAvLyBvZmZzZXQKICBwYXJzZTY0KCk7IC8vIGxlbmd0aAog
IHBhcnNlNjQoKTsgLy8gbWlubGVuZ3RoCiAgcGFyc2UzMigpOyAvLyBzdGF0ZWlkNCBzZXFpZAog
IHBhcnNlMzIoKTsgLy8gc3RhdGVpZDQgb3RoZXIKICBwYXJzZTMyKCk7IC8vIHN0YXRlaWQ0IG90
aGVyCiAgcGFyc2UzMigpOyAvLyBzdGF0ZWlkNCBvdGhlcgogIHBhcnNlMzIoKTsgLy8gY291bnQz
MgogIAogIHB1dDMyKDApOyAvLyBPSwogIHB1dDMyKDApOyAvLyByZXR1cm5fb25fY2xvc2UKICBw
dXQzMigwKTsgLy8gc3RhdGVpZDQgc2VxaWQKICBwdXQzMigwKTsgLy8gc3RhdGVpZDQgb3RoZXIK
ICBwdXQzMigwKTsgLy8gc3RhdGVpZDQgb3RoZXIKICBwdXQzMigwKTsgLy8gc3RhdGVpZDQgb3Ro
ZXIKICBwdXQzMigxKTsgLy8gIyBvZiBsYXlvdXQ0CiAgcHV0NjQoMCk7IC8vIG9mZnNldAogIHB1
dDY0KDEwMDAwMDApOyAvLyBsZW5ndGgKICBwdXQzMigzKTsgLy8gbGF5b3V0aW9tb2RlNAogIHB1
dDMyKDEpOyAvLyBsYXlvdXR0eXBlNAogIHB1dF9vcGFxdWUoOCwgInh4eHh4eHh4Iik7IC8vIGxv
Y19ib2R5Cn0KCnZvaWQKcGFyc2Vfb3Bfd3JpdGUoKQp7CiAgcGFyc2UzMigpOyAvLyBzdGF0ZWlk
NAogIHBhcnNlMzIoKTsgLy8gc3RhdGVpZDQKICBwYXJzZTMyKCk7IC8vIHN0YXRlaWQ0CiAgcGFy
c2UzMigpOyAvLyBzdGF0ZWlkNAogIHBhcnNlNjQoKTsgLy8gb2Zmc2V0CiAgcGFyc2UzMigpOyAv
LyBzdGFibGVfaG93NAogIGludCBuID0gcGFyc2Vfb3BhcXVlKDApOyAvLyBkYXRhCgogIHB1dDMy
KDApOyAvLyBPSwogIHB1dDMyKG4pOyAvLyBjb3VudAogIHB1dDMyKDApOyAvLyBVTlNUQUJMRTQK
ICBwdXQ2NCgxKTsgLy8gdmVyaWZpZXIKfQoKdm9pZApwYXJzZV9vcF9yZWFkKCkKewogIHBhcnNl
MzIoKTsgLy8gc3RhdGVpZDQKICBwYXJzZTMyKCk7IC8vIHN0YXRlaWQ0CiAgcGFyc2UzMigpOyAv
LyBzdGF0ZWlkNAogIHBhcnNlMzIoKTsgLy8gc3RhdGVpZDQKICBwYXJzZTY0KCk7IC8vIG9mZnNl
dAogIHBhcnNlMzIoKTsgLy8gY291bnQKCiAgcHV0MzIoMCk7IC8vIE9LCiAgcHV0MzIoMSk7IC8v
IGVvZgogIHB1dF9vcGFxdWUoNCwgImFiY2QiKTsKfQoKdm9pZApwYXJzZV9vcF9jb21taXQoKQp7
CiAgcGFyc2U2NCgpOyAvLyBvZmZzZXQKICBwYXJzZTMyKCk7IC8vIGNvdW50CiAgcHV0MzIoMCk7
IC8vIE9LCiAgcHV0NjQoMSk7IC8vIHZlcmlmaWVyNAp9Cgp2b2lkCnBhcnNlX29wX2Nsb3NlKCkK
ewogIHBhcnNlMzIoKTsgLy8gc2VxaWQKICBwYXJzZTMyKCk7IC8vIHN0YXRlaWQ0LnNlcWlkCiAg
cGFyc2UzMigpOyAvLyBzdGF0ZWlkNC5vdGhlcgogIHBhcnNlMzIoKTsgLy8gc3RhdGVpZDQub3Ro
ZXIKICBwYXJzZTMyKCk7IC8vIHN0YXRlaWQ0Lm90aGVyCiAgcHV0MzIoMCk7IC8vIE9LCiAgcHV0
MzIoMik7IC8vIHNlcWlkCiAgcHV0MzIoMSk7IC8vIG90aGVyCiAgcHV0MzIoMSk7CiAgcHV0MzIo
MSk7Cn0KCnZvaWQKcGFyc2Vfb3BfY3JlYXRlKCkKewogIGludCB0eXBlID0gcGFyc2UzMigpOyAv
LyB0eXBlCiAgY2hhciBuYW1lWzEyOF07CiAgbWVtc2V0KG5hbWUsIDAsIHNpemVvZihuYW1lKSk7
CiAgaW50IG5hbWVsZW4gPSBwYXJzZV9vcGFxdWUobmFtZSk7CiAgLy8gZmF0dHI0CiAgaW50IGJp
dHdvcmRzID0gcGFyc2UzMigpOwogIGludCB3b3Jkc1s2NF07CiAgZm9yKGludCBpID0gMDsgaSA8
IGJpdHdvcmRzOyBpKyspCiAgICB3b3Jkc1tpXSA9IHBhcnNlMzIoKTsKICBwYXJzZV9vcGFxdWUo
MCk7IC8vIGF0dHJsaXN0NAogIHByaW50ZigiY3JlYXRlIHR5cGU9JWQgbmFtZT0lc1xuIiwgdHlw
ZSwgbmFtZSk7CgogIGN1cnJlbnRfZmggPSBuYW1lMmZoKG5hbWUsIDEpOwogIHB1dDMyKDApOyAv
LyBPSwogIHB1dDMyKDEpOyAvLyBjaGFuZ2VfaW5mbzQuYXRvbWljCiAgcHV0NjQoMSk7IC8vIGJl
Zm9yZQogIHB1dDY0KDIpOyAvLyBhZnRlcgogIHB1dDMyKGJpdHdvcmRzKTsKICBmb3IoaW50IGkg
PSAwOyBpIDwgYml0d29yZHM7IGkrKykKICAgIHB1dDMyKHdvcmRzW2ldKTsKfQoKdm9pZApwYXJz
ZV9vcF9yZW1vdmUoKQp7CiAgY2hhciBuYW1lWzI1Nl07CiAgbWVtc2V0KG5hbWUsIDAsIHNpemVv
ZihuYW1lKSk7CiAgaW50IG5hbWVsZW4gPSBwYXJzZV9vcGFxdWUobmFtZSk7CiAgcHV0MzIoMCk7
IC8vIE9LCiAgcHV0MzIoMSk7IC8vIGNoYW5nZV9pbmZvNC5hdG9taWMKICBwdXQ2NCgxKTsgLy8g
YmVmb3JlCiAgcHV0NjQoMik7IC8vIGFmdGVyCn0KCmludCBzYXZlZF9maDsKCnZvaWQKcGFyc2Vf
b3Bfc2F2ZWZoKCkKewogIHNhdmVkX2ZoID0gY3VycmVudF9maDsKICBwdXQzMigwKTsgLy8gT0sK
fQoKdm9pZApwYXJzZV9vcF9yZXN0b3JlZmgoKQp7CiAgY3VycmVudF9maCA9IHNhdmVkX2ZoOwog
IHB1dDMyKDApOyAvLyBPSwp9Cgp2b2lkCnBhcnNlX29wX3JlbmFtZSgpCnsKICBjaGFyIG5hbWUx
WzI1Nl0sIG5hbWUyWzI1Nl07CiAgbWVtc2V0KG5hbWUxLCAwLCBzaXplb2YobmFtZTEpKTsKICBt
ZW1zZXQobmFtZTIsIDAsIHNpemVvZihuYW1lMikpOwogIHBhcnNlX29wYXF1ZShuYW1lMSk7CiAg
cGFyc2Vfb3BhcXVlKG5hbWUyKTsKICBwcmludGYoInJlbmFtZSAlcyAlc1xuIiwgbmFtZTEsIG5h
bWUyKTsKCiAgcHV0MzIoMCk7IC8vIE9LCiAgLy8gY2hhbmdlX2luZm80CiAgcHV0MzIoMSk7CiAg
cHV0NjQoMSk7IC8vIGJlZm9yZQogIHB1dDY0KDIpOyAvLyBhZnRlcgogIC8vIGNoYW5nZV9pbmZv
NAogIHB1dDMyKDEpOwogIHB1dDY0KDMpOyAvLyBiZWZvcmUKICBwdXQ2NCg0KTsgLy8gYWZ0ZXIK
fQoKdm9pZApwYXJzZV9vcF9zZWVrKCkKewogIC8vIHN0YXRlaWQ0CiAgcGFyc2UzMigpOyAvLyBz
ZXFpZAogIHBhcnNlMzIoKTsKICBwYXJzZTMyKCk7CiAgcGFyc2UzMigpOwogIGxvbmcgb2Zmc2V0
ID0gcGFyc2U2NCgpOyAvLyBvZmZzZXQKICBpbnQgd2hhdCA9IHBhcnNlMzIoKTsKICBwcmludGYo
InNlZWsgb2Zmc2V0PSVsZCB3aGF0PSVkXG4iLCBvZmZzZXQsIHdoYXQpOwogIHB1dDMyKDApOyAv
LyBPSwogIGlmKHdoYXQgPT0gMCl7CiAgICAvLyBuZXh0IGRhdGE/CiAgICBpZihvZmZzZXQgPj0g
MzIpewogICAgICBwdXQzMigxKTsKICAgICAgcHV0NjQob2Zmc2V0KTsKICAgIH0gZWxzZSB7CiAg
ICAgIHB1dDMyKDApOwogICAgICBwdXQ2NChvZmZzZXQgKyAxKTsKICAgIH0KICB9IGVsc2Ugewog
ICAgLy8gbmV4dCBob2xlPwogICAgaWYob2Zmc2V0ID49IDMyKXsKICAgICAgcHV0MzIoMSk7CiAg
ICAgIHB1dDY0KG9mZnNldCk7CiAgICB9IGVsc2UgewogICAgICBwdXQzMigwKTsKICAgICAgcHV0
NjQoMzIpOwogICAgfQogIH0KfQoKdm9pZApwYXJzZV9vcF9jb3B5KCkKewogIC8vIHN0YXRlaWQ0
CiAgcGFyc2UzMigpOyAvLyBzZXFpZAogIHBhcnNlMzIoKTsKICBwYXJzZTMyKCk7CiAgcGFyc2Uz
MigpOwogIC8vIHN0YXRlaWQ0CiAgcGFyc2UzMigpOyAvLyBzZXFpZAogIHBhcnNlMzIoKTsKICBw
YXJzZTMyKCk7CiAgcGFyc2UzMigpOwogIHBhcnNlNjQoKTsgLy8gb2Zmc2V0CiAgcGFyc2U2NCgp
OyAvLyBvZmZzZXQKICBsb25nIGxvbmcgY291bnQgPSBwYXJzZTY0KCk7IC8vIGNvdW50CiAgcGFy
c2UzMigpOyAvLyBjb25zZWN1dGl2ZQogIHBhcnNlMzIoKTsgLy8gc3luY2hyb25vdXMKICBpbnQg
bmxvYyA9IHBhcnNlMzIoKTsKICBmb3IoaW50IGkgPSAwOyBpIDwgbmxvYzsgaSsrKXsKICAgIGlu
dCB0eXBlID0gcGFyc2UzMigpOwogICAgaWYodHlwZSA9PSAxIHx8IHR5cGUgPT0gMil7CiAgICAg
IHBhcnNlX29wYXF1ZSgwKTsgLy8gbmFtZSBvZiB1cmwKICAgIH0gZWxzZSB7CiAgICAgIHBhcnNl
X29wYXF1ZSgwKTsgLy8gbmV0d29yayBpZAogICAgICBwYXJzZV9vcGFxdWUoMCk7IC8vIHVuaXZl
cnNhbCBhZGRyZXNzCiAgICB9CiAgfQoKICBwdXQzMigwKTsgLy8gT0sKICAvLyBzdGF0ZWlkNCBj
YWxsYmFja19pZDwxPgogIGlmKDEpewogICAgcHV0MzIoMCk7IC8vIG4KICB9IGVsc2UgewogICAg
cHV0MzIoMSk7IC8vIG4KICAgIHB1dDMyKDEpOyAvLyBzZXFpZAogICAgcHV0MzIoMSk7IC8vIG90
aGVyCiAgICBwdXQzMigxKTsKICAgIHB1dDMyKDEpOwogIH0KICBwdXQ2NChjb3VudCk7IC8vIGNv
dW50CiAgcHV0MzIoMCk7IC8vIHN0YWJsZV9ob3cgVU5TVEFCTEUKICBwdXQ2NCgwKTsgLy8gdmVy
aWZpZXIKICBwdXQzMigxKTsgLy8gY29uc2VjdXRpdmUKICBwdXQzMigxKTsgLy8gc3luY2hyb25v
dXMKfQoKdm9pZApwYXJzZV9vcF9sb2NrKCkKewogIHBhcnNlMzIoKTsgLy8gbG9jayB0eXBlCiAg
cGFyc2UzMigpOyAvLyByZWNsYWltCiAgcGFyc2U2NCgpOyAvLyBvZmZzZXQKICBwYXJzZTY0KCk7
IC8vIGxlbmd0aAogIGludCBvd25lciA9IHBhcnNlMzIoKTsgLy8gbG9jazQgbmV3X2xvY2tfb3du
ZXIKICBpZihvd25lcil7CiAgICBwYXJzZTMyKCk7IC8vIG9wZW5fc2VxaWQKICAgIC8vIHN0YXRl
aWQ0CiAgICBwYXJzZTMyKCk7IC8vIHNlcWlkCiAgICBwYXJzZTMyKCk7CiAgICBwYXJzZTMyKCk7
CiAgICBwYXJzZTMyKCk7CiAgICBwYXJzZTMyKCk7IC8vIGxvY2tfc2VxaWQKICAgIHBhcnNlNjQo
KTsgLy8gY2xpZW50aWQKICAgIHBhcnNlX29wYXF1ZSgwKTsgLy8gb3duZXIKICB9IGVsc2Ugewog
ICAgLy8gc3RhdGVpZDQKICAgIHBhcnNlMzIoKTsgLy8gc2VxaWQKICAgIHBhcnNlMzIoKTsKICAg
IHBhcnNlMzIoKTsKICAgIHBhcnNlMzIoKTsKICAgIHBhcnNlMzIoKTsgLy8gc2VxaWQKICB9Cgog
IHB1dDMyKDApOyAvLyBPSwogIC8vIHN0YXRlaWQ0CiAgcHV0MzIoMSk7IC8vIHNlcWlkCiAgcHV0
MzIoMSk7IC8vIG90aGVyCiAgcHV0MzIoMSk7CiAgcHV0MzIoMSk7CgogIHNlbmRfYmFjayA9IDE7
Cn0KCnZvaWQKcGFyc2Vfb3BfbG9ja3UoKQp7CiAgcGFyc2UzMigpOyAvLyBsb2NrIHR5cGUKICBw
YXJzZTMyKCk7IC8vIHNlcWlkCiAgLy8gc3RhdGVpZDQKICBwYXJzZTMyKCk7IC8vIHNlcWlkCiAg
cGFyc2UzMigpOwogIHBhcnNlMzIoKTsKICBwYXJzZTMyKCk7CiAgcGFyc2U2NCgpOyAvLyBvZmZz
ZXQKICBwYXJzZTY0KCk7IC8vIGxlbmd0aAoKICBwdXQzMigwKTsgLy8gT0sKICAvLyBzdGF0ZWlk
NAogIHB1dDMyKDEpOyAvLyBzZXFpZAogIHB1dDMyKDEpOyAvLyBvdGhlcgogIHB1dDMyKDEpOwog
IHB1dDMyKDEpOwp9Cgp2b2lkCnBhcnNlX29wX2ZyZWVfc3RhdGVpZCgpCnsKICAvLyBzdGF0ZWlk
NAogIHBhcnNlMzIoKTsgLy8gc2VxaWQKICBwYXJzZTMyKCk7CiAgcGFyc2UzMigpOwogIHBhcnNl
MzIoKTsKCiAgcHV0MzIoMCk7IC8vIE9LCn0KCnZvaWQKcGFyc2VfY29tcG91bmQoKQp7CiAgY2hh
ciB0YWdbNTEyXTsKICBpbnQgdGFnbGVuID0gcGFyc2Vfb3BhcXVlKHRhZyk7IC8vIHRhZwogIHBh
cnNlMzIoKTsgLy8gY2xpZW50IG1pbm9yIHZlcnNpb24KICBpbnQgbm9wcyA9IHBhcnNlMzIoKTsK
CiAgLy8gc3RhcnQgYSBDT01QT1VORDRyZXMKICBpbnQgc3RhdHVzX29pID0gb2k7CiAgY29tcG91
bmRfc3RhdHVzID0gMDsKICBwdXQzMihjb21wb3VuZF9zdGF0dXMpOyAvLyBwbGFjZS1ob2xkZXIK
ICBwdXRfb3BhcXVlKHRhZ2xlbiwgdGFnKTsKICBwdXQzMihub3BzKTsgLy8gbGVuZ3RoIG9mIHJl
c2FycmF5PD4KICAKICBpbnQgb3BpbmRleCA9IDA7CiAgZm9yKG9waW5kZXggPSAwOyBvcGluZGV4
IDwgbm9wcyAmJiBpaSA8IGlsZW47IG9waW5kZXgrKyl7CiAgICBpbnQgb3AgPSBwYXJzZTMyKCk7
CiAgICBwcmludGYoIm9wICVkICMlZFxuIiwgb3AsIG9wY291bnRzW29wJjB4ZmZdKTsKICAgIHB1
dDMyKG9wKTsgLy8gcmVzb3AgaW4gbmZzX3Jlc29wNAogICAgaWYoc3ltX29wID09IG9wKXsKICAg
ICAgaWYoc3ltX3NraXAgPD0gMCl7CiAgICAgICAgc3ltc3RhcnQgPSBvaTsKICAgICAgfQogICAg
ICBzeW1fc2tpcCAtPSAxOwogICAgfQogICAgaWYob3AgPT0gNDIpewogICAgICBwYXJzZV9vcF9l
eGNoYW5nZV9pZCgpOwogICAgfSBlbHNlIGlmKG9wID09IDQzKXsKICAgICAgcGFyc2Vfb3BfY3Jl
YXRlX3Nlc3Npb24oKTsKICAgIH0gZWxzZSBpZihvcCA9PSA1Myl7CiAgICAgIHBhcnNlX29wX3Nl
cXVlbmNlKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gNTgpewogICAgICBwYXJzZV9vcF9yZWNsYWlt
X2NvbXBsZXRlKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gMjQpewogICAgICBwYXJzZV9vcF9wdXRy
b290ZmgoKTsKICAgIH0gZWxzZSBpZihvcCA9PSA1Mil7CiAgICAgIHBhcnNlX29wX3NlY2luZm9f
bm9fbmFtZSgpOwogICAgfSBlbHNlIGlmKG9wID09IDQ0KXsKICAgICAgcGFyc2Vfb3BfZGVzdHJv
eV9zZXNzaW9uKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gNTcpewogICAgICBwYXJzZV9vcF9kZXN0
cm95X2NsaWVudGlkKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gMTApewogICAgICBwYXJzZV9vcF9n
ZXRmaCgpOwogICAgfSBlbHNlIGlmKG9wID09IDkpewogICAgICBwYXJzZV9vcF9nZXRhdHRyKCk7
CiAgICB9IGVsc2UgaWYob3AgPT0gMjIpewogICAgICBwYXJzZV9vcF9wdXRmaCgpOwogICAgfSBl
bHNlIGlmKG9wID09IDMpewogICAgICBwYXJzZV9vcF9hY2Nlc3MoKTsKICAgIH0gZWxzZSBpZihv
cCA9PSAxNSl7CiAgICAgIHBhcnNlX29wX2xvb2t1cCgpOwogICAgfSBlbHNlIGlmKG9wID09IDE2
KXsKICAgICAgcGFyc2Vfb3BfbG9va3VwcCgpOwogICAgfSBlbHNlIGlmKG9wID09IDI2KXsKICAg
ICAgcGFyc2Vfb3BfcmVhZGRpcigpOwogICAgfSBlbHNlIGlmKG9wID09IDE4KXsKICAgICAgcGFy
c2Vfb3Bfb3BlbigpOwogICAgfSBlbHNlIGlmKG9wID09IDQ1KXsKICAgICAgcGFyc2Vfb3BfZnJl
ZV9zdGF0ZWlkKCk7CiAgICB9IGVsc2UgaWYob3AgPT0gMTIpewogICAgICBwYXJzZV9vcF9sb2Nr
KCk7CiAgICB9IGVsc2UgaWYob3AgPT0gMTQpewogICAgICBwYXJzZV9vcF9sb2NrdSgpOwogICAg
fSBlbHNlIGlmKG9wID09IDYpewogICAgICBwYXJzZV9vcF9jcmVhdGUoKTsKICAgIH0gZWxzZSBp
ZihvcCA9PSAyOCl7CiAgICAgIHBhcnNlX29wX3JlbW92ZSgpOwogICAgfSBlbHNlIGlmKG9wID09
IDQpewogICAgICBwYXJzZV9vcF9jbG9zZSgpOwogICAgfSBlbHNlIGlmKG9wID09IDM0KXsKICAg
ICAgcGFyc2Vfb3Bfc2V0YXR0cigpOwogICAgfSBlbHNlIGlmKG9wID09IDUwKXsKICAgICAgcGFy
c2Vfb3BfbGF5b3V0Z2V0KCk7CiAgICB9IGVsc2UgaWYob3AgPT0gMzgpewogICAgICBwYXJzZV9v
cF93cml0ZSgpOwogICAgfSBlbHNlIGlmKG9wID09IDI1KXsKICAgICAgcGFyc2Vfb3BfcmVhZCgp
OwogICAgfSBlbHNlIGlmKG9wID09IDUpewogICAgICBwYXJzZV9vcF9jb21taXQoKTsKICAgIH0g
ZWxzZSBpZihvcCA9PSAzMil7CiAgICAgIHBhcnNlX29wX3NhdmVmaCgpOwogICAgfSBlbHNlIGlm
KG9wID09IDMxKXsKICAgICAgcGFyc2Vfb3BfcmVzdG9yZWZoKCk7CiAgICB9IGVsc2UgaWYob3Ag
PT0gMjkpewogICAgICBwYXJzZV9vcF9yZW5hbWUoKTsKICAgIH0gZWxzZSBpZihvcCA9PSA2OSl7
CiAgICAgIHBhcnNlX29wX3NlZWsoKTsKICAgIH0gZWxzZSBpZihvcCA9PSA2MCl7CiAgICAgIHBh
cnNlX29wX2NvcHkoKTsKICAgIH0gZWxzZSB7CiAgICAgIHByaW50ZigidW5rbm93biBvcCAlZFxu
Iiwgb3ApOwogICAgICAvLyBjYW5ub3QgY29udGludWUgdG8gdGhlIG5leHQgb3Agc2luY2UKICAg
ICAgLy8gd2UgZG9uJ3Qga25vdyBob3cgbG9uZyB0aGlzIG9uZSBpcy4KICAgICAgYnJlYWs7CiAg
ICB9CiAgICBvcGNvdW50c1tvcCYweGZmXSArPSAxOwogIH0KICAqKGludCopKG9idWYrc3RhdHVz
X29pKSA9IGh0b25sKGNvbXBvdW5kX3N0YXR1cyk7CiAgaWYob3BpbmRleCAhPSBub3BzKQogICAg
cHJpbnRmKCJjb21wb3VuZCB3aXRoICVkIG5vcHMgYnV0IG9ubHkgZW5vdWdoIGJ5dGVzIGZvciAl
ZFxuIiwgbm9wcywgb3BpbmRleCk7CiAgaWYoaWkgIT0gaWxlbikKICAgIHByaW50ZigiY29tcG91
bmQgY29uc3VtZWQgb25seSAlZCBvZiAlZCBieXRlc1xuIiwgaWksIGlsZW4pOwp9Cgp2b2lkCnBh
cnNlX3JwYygpCnsKICAvLyBTVU4gUlBDCiAgaW50IHhpZCA9IHBhcnNlMzIoKTsKICBpbnQgbXR5
cGUgPSBwYXJzZTMyKCk7IC8vIG10eXBlLCAwPUNBTEwsIDE9UkVQTFkKICBpZihtdHlwZSA9PSAx
KXsKICAgIC8vIHJwYyByZXBseQogICAgaW50IHN0YXQwID0gcGFyc2UzMigpOyAvLyBNU0dfQUND
RVBURUQKICAgIGludCBmbGF2b3IgPSBwYXJzZTMyKCk7CiAgICBwYXJzZV9vcGFxdWUoMCk7IC8v
IHZlcmYKICAgIGludCBzdGF0MSA9IHBhcnNlMzIoKTsgLy8gc3RhdHVzCiAgICBpbnQgc3RhdDIg
PSBwYXJzZTMyKCk7IC8vIHN0YXR1cwogICAgcGFyc2Vfb3BhcXVlKDApOwogICAgaW50IG5vcHMg
PSBwYXJzZTMyKCk7CiAgICBpbnQgb3AgPSBwYXJzZTMyKCk7CiAgICBwcmludGYoImdvdCBhIGJh
Y2tjaGFubmVsIHJlcGx5LCBzdGF0ICVkICVkLCBub3BzICVkIG9wMSAlZFxuIiwgc3RhdDEsIHN0
YXQyLCBub3BzLCBvcCk7CiAgICAvLyBwcmludGYoImdvdCBhIGJhY2tjaGFubmVsIHJlcGx5XG4i
KTsKICAgIHJldHVybjsKICB9CiAgcGFyc2UzMigpOyAvLyBycGMgdmVyc2lvbgogIHBhcnNlMzIo
KTsgLy8gcHJvZyMKICBwYXJzZTMyKCk7IC8vIHByb2cgdmVycwogIGludCBwcm9jID0gcGFyc2Uz
MigpOwogIHBhcnNlMzIoKTsgLy8gY3JlZCB0eXBlCiAgcGFyc2Vfb3BhcXVlKDApOyAvLyBjcmVk
CiAgcGFyc2UzMigpOyAvLyB2ZXJmIHR5cGUKICBwYXJzZV9vcGFxdWUoMCk7IC8vIHZlcmYKCiAg
cHV0MzIoeGlkKTsKICBwdXQzMigxKTsgLy8gUkVQTFkKICBwdXQzMigwKTsgLy8gTVNHX0FDQ0VQ
VEVECiAgcHV0MzIoMCk7IC8vIG9wYXF1ZV9hdXRoIGZsYXZvciA9IEFVVEhfTlVMTAogIHB1dDMy
KDApOyAvLyBvcGFxdWVfYXV0aCBsZW5ndGgKICBwdXQzMigwKTsgLy8gU1VDQ0VTUwoKICBpZihw
cm9jID09IDApewogICAgcGFyc2Vfbm9wKCk7CiAgfSBlbHNlIGlmKHByb2MgPT0gMSl7CiAgICBw
YXJzZV9jb21wb3VuZCgpOwogIH0gZWxzZSB7CiAgICBwcmludGYoInVua25vd24gcnBjIHByb2Mg
JWRcbiIsIHByb2MpOwogIH0KfQoKdm9pZApwdXRfcnBjX2hlYWRlcihpbnQgcHJvZywgaW50IHBy
b2MpCnsKICBpbnQgeGlkID0gMTsKICBwdXQzMih4aWQrKyk7CiAgcHV0MzIoMCk7IC8vIG10eXBl
PUNBTEwKICBwdXQzMigyKTsgLy8gcnBjIHZlcnNpb24KICBwdXQzMihwcm9nKTsgLy8gcHJvZyAj
IC0tIG5mcyB2NCBjYWxsYmFjawogIHB1dDMyKDEpOyAvLyBwcm9nIHZlcnMKICBwdXQzMihwcm9j
KTsgLy8gcHJvYwogIGlmKHByb2MgPT0gMCl7CiAgICBwdXQzMigwKTsgLy8gY3JlZCB0eXBlCiAg
ICBwdXQzMigwKTsgLy8gY3JlZCBsZW4KICB9IGVsc2UgewogICAgcHV0MzIoMSk7IC8vIGNyZWQg
dHlwZSBBVVRIX1NZUyAvIEFVVEhfVU5JWAogICAgcHV0MzIoMzIpOyAvLyBjcmVkIGxlbmd0aAog
ICAgcHV0MzIoMCk7IC8vIHN0YW1wCiAgICBwdXRfb3BhcXVlKDksICJsb2NhbGhvc3QiKTsKICAg
IHB1dDMyKDY1NTM0KTsgLy8gdWlkCiAgICBwdXQzMig2NTUzNCk7IC8vIGdpZAogICAgcHV0MzIo
MCk7IC8vICMgZ2lkcwogIH0KICBwdXQzMigwKTsgLy8gdmVyZiB0eXBlCiAgcHV0MzIoMCk7IC8v
IHZlcmYgbGVuCn0KCnZvaWQKc3lzKGNvbnN0IGNoYXIgKmNtZCkKewogIHZvbGF0aWxlIGludCB4
ID0gc3lzdGVtKGNtZCk7CiAgKHZvaWQpIHg7Cn0KCmludAptYWluKCl7CiAgc2V0bGluZWJ1Zihz
dGRvdXQpOwogIHN0cnVjdCBybGltaXQgcjsKICByLnJsaW1fY3VyID0gci5ybGltX21heCA9IDA7
CiAgc2V0cmxpbWl0KFJMSU1JVF9DT1JFLCAmcik7CgogIGludCBzID0gc29ja2V0KEFGX0lORVQs
IFNPQ0tfU1RSRUFNLCAwKTsKICBzdHJ1Y3Qgc29ja2FkZHJfaW4gc2luOwogIG1lbXNldCgmc2lu
LCAwLCBzaXplb2Yoc2luKSk7CiAgc2luLnNpbl9mYW1pbHkgPSBBRl9JTkVUOwogIHNpbi5zaW5f
cG9ydCA9IGh0b25zKDIwNDkpOwogIGludCB5ZXMgPSAxOwogIHNldHNvY2tvcHQocywgU09MX1NP
Q0tFVCwgU09fUkVVU0VBRERSLCAmeWVzLCBzaXplb2YoeWVzKSk7CiAgaWYoYmluZChzLCAoc3Ry
dWN0IHNvY2thZGRyICopJnNpbiwgc2l6ZW9mKHNpbikpIDwgMCl7CiAgICBwZXJyb3IoImJpbmQi
KTsgZXhpdCgxKTsKICB9CiAgbGlzdGVuKHMsIDEwKTsKICBzeW5jKCk7CgogIGludCBwaWQxID0g
Zm9yaygpOwogIGlmKHBpZDEgPT0gMCl7CiAgICBjbG9zZShzKTsKICAgIHNsZWVwKDEpOwogICAg
aWYoc3lzdGVtKCJlY2hvIC1uIG1vdW50OiA7IG1vdW50IC1vIG5vbG9jayxub2RldiAxMjcuMC4w
LjE6L3RtcCAvbW50IikgPT0gMCl7CiAgICAgIGlmKDApewogICAgICAgIHByaW50Zigic3RhdGZz
OiAiKTsgZmZsdXNoKHN0ZG91dCk7CiAgICAgICAgc3RydWN0IHN0YXRmcyBzYjsKICAgICAgICBp
bnQgcmV0ID0gc3RhdGZzKCIvbW50Ly4iLCAmc2IpOwogICAgICAgIHByaW50Zigic3RhdGZzIC0+
ICVkXG4iLCByZXQpOwogICAgICB9CiAgICAgIGlmKDApewogICAgICAgIGludCBmZCA9IG9wZW4o
Ii9tbnQiLCAwKTsKICAgICAgICBpZihmZCA8IDApIHsgcGVycm9yKCIvbW50Iik7IGV4aXQoMSk7
IH0KICAgICAgICBvZmZfdCBiYXNlID0gMDsKICAgICAgICBjaGFyIGJ1Zls0MDk2XTsKICAgICAg
ICBzc2l6ZV90IHJldCA9IGdldGRpcmVudHJpZXMoZmQsIGJ1Ziwgc2l6ZW9mKGJ1ZiksICZiYXNl
KTsKICAgICAgICBwcmludGYoImdldGRpcmVudHJpZXMgcmV0ICVsZCBlcnJubyAlZFxuIiwgcmV0
LCBlcnJubyk7CiAgICAgICAgaWYocmV0IDwgMCkgcGVycm9yKCJnZXRkaXJlbnRyaWVzIik7CiAg
ICAgICAgY2xvc2UoZmQpOwogICAgICB9CiAgICAgIGlmKDApewogICAgICAgIGludCBmZCA9IG9w
ZW4oIi9tbnQveCIsIDApOwogICAgICAgIHByaW50Zigib3BlbiAvbW50L3ggLT4gJWQgZXJybm8g
JWRcbiIsIGZkLCBlcnJubyk7CiAgICAgICAgaWYoZmQgPCAwKSBwZXJyb3IoIi9tbnQveCIpOwog
ICAgICAgIGNsb3NlKGZkKTsKICAgICAgfQogICAgICBpZigxKXsKICAgICAgICBpbnQgZmQgPSBv
cGVuKCIvbW50L25ldyIsIE9fUkRXUnxPX0NSRUFULCAwNjY2KTsKICAgICAgICBwcmludGYoImNy
ZWF0IC9tbnQvbmV3IC0+ICVkIGVycm5vICVkXG4iLCBmZCwgZXJybm8pOwogICAgICAgIGlmKGZk
IDwgMCkgcGVycm9yKCIvbW50L25ldyIpOwogICAgICAgIGlmKHdyaXRlKGZkLCAieCIsIDEpIDwg
MCkgcGVycm9yKCJ3cml0ZSIpOwogICAgICAgIGxzZWVrKGZkLCAwTCwgMCk7CiAgICAgICAgY2hh
ciBidWZbNTEyXTsKICAgICAgICB2b2xhdGlsZSBpbnQganVuayA9IHJlYWQoZmQsIGJ1Ziwgc2l6
ZW9mKGJ1ZikpOwogICAgICAgICh2b2lkKSBqdW5rOwogICAgICAgIC8vbWtkaXIoIi9tbnQvbmV3
L25ld25ldyIsIDA3NzcpOwogICAgICAgIC8vaWYodW5saW5rKCIvbW50L25ldyIpIDwgMCkgcGVy
cm9yKCJ1bmxpbmsiKTsKICAgICAgICAvL2Nsb3NlKGZkKTsKICAgICAgICBpZihmbG9jayhmZCwg
TE9DS19FWCkgPCAwKSBwZXJyb3IoImZsb2NrIik7CiAgICAgICAgc2xlZXAoMSk7CiAgICAgIH0K
ICAgICAgaWYoMCl7CiAgICAgICAgaW50IHJldCA9IG1rZGlyKCIvbW50L2QiLCAwNzc3KTsKICAg
ICAgICBwcmludGYoIm1rZGlyIC9tbnQvZCAtPiAlZCBlcnJubyAlZFxuIiwgcmV0LCBlcnJubyk7
CiAgICAgICAgaWYocmV0IDwgMCkgcGVycm9yKCJta2RpciAvbW50L2QiKTsKICAgICAgICBpZihj
aGRpcigiL21udC9kIikgPT0gMCl7CiAgICAgICAgICBwcmludGYoImNoZGlyIHN1Y2NlZWRlZFxu
Iik7CiAgICAgICAgICBpZihjcmVhdCgibmV3bmV3bmV3IiwgMDY2NikgPCAwKSBwZXJyb3IoImNy
ZWF0ZSBuZXduZXduZXciKTsKICAgICAgICAgIHVubGluaygibmV3bmV3bmV3Iik7CiAgICAgICAg
fSBlbHNlIHsKICAgICAgICAgIHBlcnJvcigiY2hkaXIgL21udC9kIik7CiAgICAgICAgfQogICAg
ICAgIGNyZWF0KCIvbW50L2QvbmV3bmV3IiwgMDY2Nik7CiAgICAgICAgcm1kaXIoIi9tbnQvZCIp
OwogICAgICB9CiAgICAgIGlmKDApewogICAgICAgIHN5cygic2V0ZmFjbCAtbSBvd25lckA6cnd4
cDo6YWxsb3cgL21udC94Iik7CiAgICAgICAgc3lzKCJnZXRmYWNsIC9tbnQveCIpOwogICAgICB9
CiAgICAgIGlmKDApewogICAgICAgIGludCBmZCA9IG9wZW4oIi9tbnQvbmV3IiwgT19SRFdSfE9f
Q1JFQVQsIDA2NjYpOwogICAgICAgIGlmKGZkIDwgMCkgcGVycm9yKCJvcGVuIC9tbnQvbmV3Iik7
CiAgICAgICAgY2hhciBidWZbMzJdOwogICAgICAgIG1lbXNldChidWYsIDEsIHNpemVvZihidWYp
KTsKICAgICAgICBpZih3cml0ZShmZCwgYnVmLCBzaXplb2YoYnVmKSkgPCAwKSBwZXJyb3IoIndy
aXRlIik7CiAgICAgICAgbHNlZWsoZmQsIChvZmZfdCkwLCAwKTsKICAgICAgICBpbnQgZmQyID0g
Y3JlYXQoIi9tbnQvbmV3bmV3IiwgMDY2Nik7CiAgICAgICAgaWYoZmQyIDwgMCkgcGVycm9yKCJj
cmVhdCAvbW50L25ld25ldyIpOwogICAgICAgIG9mZl90IG8xID0gMDsKICAgICAgICBvZmZfdCBv
MiA9IDA7CiAgICAgICAgaWYoY29weV9maWxlX3JhbmdlKGZkLCAmbzEsIGZkMiwgJm8yLCAxNiwg
MCkgPCAwKSBwZXJyb3IoImNvcHlfZmlsZV9yYW5nZSIpOwogICAgICB9CiAgICAgIGlmKDApewog
ICAgICAgIHN5cygiZWNobyAtbiBsczogOyBscyAtbCAvbW50Iik7CiAgICAgICAgc3lzKCJlY2hv
IC1uIGxzOiA7IGxzIC1sIC9tbnQvLiAvbW50L3oiKTsKICAgICAgICBzeXMoImVjaG8gLW4gZWNo
bzogOyBlY2hvIGhpID4gL21udC94Iik7CiAgICAgICAgc3lzKCJlY2hvIC1uIGRkOiA7IGRkIGlm
PS9tbnQveSBvZj0vZGV2L251bGwgYnM9NTEyIGNvdW50PTEiKTsKICAgICAgICBzeXMoImVjaG8g
LW4gdW1vdW50OiA7IHVtb3VudCAvbW50Iik7CiAgICAgIH0KICAgIH0KICAgIGV4aXQoMCk7CiAg
fQoKICBpbnQgcGlkMiA9IGZvcmsoKTsKICBpZihwaWQyID09IDApewoKICAgIHdoaWxlKDEpewog
ICAgICBzb2NrbGVuX3Qgc2lubGVuID0gc2l6ZW9mKHNpbik7CiAgICAgIHByaW50ZigiY2FsbGlu
ZyBhY2NlcHRcbiIpOwogICAgICBpbnQgczEgPSBhY2NlcHQocywgKHN0cnVjdCBzb2NrYWRkciAq
KSAmc2luLCAmc2lubGVuKTsKICAgICAgcHJpbnRmKCJhY2NlcHQgcmV0dXJuZWQgJWRcbiIsIHMx
KTsKICAgICAgaWYoczEgPCAwKSB7IHBlcnJvcigiYWNjZXB0Iik7IGV4aXQoMSk7IH0KICAgICAg
CiAgICAgIHdoaWxlKDEpewogICAgICAgIGlmKHJlYWRuKHMxLCAmaWxlbiwgNCkgPCAwKSBicmVh
azsKICAgICAgICBpbGVuID0gbnRvaGwoaWxlbik7CiAgICAgICAgaWxlbiAmPSAweDdmZmZmZmZm
OwogICAgICAgIGlmKHJlYWRuKHMxLCBpYnVmLCBpbGVuKSA8IDApIGJyZWFrOwogICAgICAgIG9p
ID0gaWkgPSAwOwogICAgICAgIHB1dDMyKDApOyAvLyBwbGFjZS1ob2xkZXIgZm9yIGxlbmd0aAog
ICAgICAgIHBhcnNlX3JwYygpOwojaWYgMQogICAgICAgIGlmKHN5bXN0YXJ0ICE9IC0xKXsKICAg
ICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCAxNjsgaSsrKQogICAgICAgICAgICBwdXQzMigweGZm
ZmZmZmZmKTsKICAgICAgICB9CiNlbmRpZgogICAgICAgICooaW50Kikob2J1ZiswKSA9IGh0b25s
KChvaSAtIDQpIHwgMHg4MDAwMDAwMCk7CiAgICAgICAgaWYoYWFpID4gTkFBKXsKICAgICAgICAg
IHByaW50Zigib29wcyBhYWkgJWQgTkFBICVkXG4iLCBhYWksIE5BQSk7CiAgICAgICAgICBleGl0
KDEpOwogICAgICAgIH0KICAgICAgICBpZihzeW1zdGFydCAhPSAtMSl7CiAgICAgICAgICBmb3Io
aW50IGkgPSBzeW1zdGFydDsgaSA8IG9pICYmIGFhaSA8IE5BQTsgaSArPSA4KQogICAgICAgICAg
ICAqKHVuc2lnbmVkIGxvbmcgbG9uZyAqKShvYnVmICsgaSkgXj0gYWFbYWFpKytdOwogICAgICAg
ICAgc3ltc3RhcnQgPSAtMTsKICAgICAgICB9CiAgICAgICAgaWYob2kgPiAwKXsKICAgICAgICAg
IGlmKHdyaXRlKHMxLCBvYnVmLCBvaSk8PTApIHBlcnJvcigid3JpdGUiKTsKICAgICAgICB9Cgog
ICAgICAgIGlmKHNlbmRfYmFjayl7CiAgICAgICAgICBzZW5kX2JhY2sgPSAwOwogICAgICAgICAg
b2kgPSAwOwogICAgICAgICAgcHV0MzIoMCk7IC8vIGR1bW15IGxlbmd0aAogICAgICAgICAgcHV0
X3JwY19oZWFkZXIoMHg0MDAwMDAwMCwgMSk7CgogICAgICAgICAgLy8gQ0JfQ09NUE9VTkQKICAg
ICAgICAgIHB1dF9vcGFxdWUoMCwgIiIpOyAvLyBjb21wb3VuZCB0YWcKICAgICAgICAgIHB1dDMy
KDIpOyAvLyBtaW5vciB2ZXJzaW9uCiAgICAgICAgICBwdXQzMigwKTsgLy8gY2FsbGJhY2tfaWRl
bnQKICAgICAgICAgIHB1dDMyKDIpOyAvLyBvcGVyYXRpb25zIGluIHRoZSBjb21wb3VuZAoKICAg
ICAgICAgIC8vIENCX1NFUVVFTkNFCiAgICAgICAgICBwdXQzMigxMSk7CiAgICAgICAgICBmb3Io
aW50IGkgPSAwOyBpIDwgNDsgaSsrKQogICAgICAgICAgICBwdXQzMigxKTsgLy8gc2Vzc2lvbmlk
CiAgICAgICAgICBwdXQzMigxKTsgLy8gc2VxdWVuY2VpZCA/Pz8KICAgICAgICAgIHB1dDMyKDAp
OyAvLyBzbG90aWQKICAgICAgICAgIHB1dDMyKDApOyAvLyBoaWdoZXN0X3Nsb3RpZAogICAgICAg
ICAgcHV0MzIoMCk7IC8vIGNhY2hldGhpcwogICAgICAgICAgcHV0MzIoMCk7IC8vIGNzYV9yZWZl
cnJpbmdfY2FsbF9saXN0czw+CiAgICAgICAgICAKICAgICAgICAgIGludCB4b2kgPSBvaTsKICAg
ICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCAzMjsgaSsrKQogICAgICAgICAgICBwdXQzMigweGZm
ZmZmZmZmKTsKICAgICAgICAgIGZvcihpbnQgaSA9IHhvaTsgaSA8IG9pICYmIGFhaSA8IE5BQTsg
aSArPSA4KQogICAgICAgICAgICAqKHVuc2lnbmVkIGxvbmcgbG9uZyAqKShvYnVmICsgaSkgXj0g
YWFbYWFpKytdOwogICAgICAgICAgKihpbnQqKShvYnVmKzApID0gaHRvbmwoKG9pIC0gNCkgfCAw
eDgwMDAwMDAwKTsKICAgICAgICAgIGlmKHdyaXRlKHMxLCBvYnVmLCBvaSk8PTApIHBlcnJvcigi
d3JpdGUiKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY2xvc2UoczEpOwogICAgfQogICAgZXhp
dCgxKTsKICB9CiAgY2xvc2Uocyk7CiAgc2xlZXAoMjApOwogIGlmKHN5c3RlbSgiZG1lc2cgfCBn
cmVwICd1bmhhbmRsZWQgc2lnJyIpID09IDApewogICBwcmludGYoInVuaGFuZGxlZCBzaWduYWxc
biIpOyB3aGlsZSgxKXt9CiAgfQp9Cg==
--=-=-=--
